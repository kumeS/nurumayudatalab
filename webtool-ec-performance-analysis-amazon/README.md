================================================================================
Amazon ASIN Performance Tracker 仕様書
================================================================================
作成日: 2026年1月2日
バージョン: 1.0

================================================================================
1. システム概要
================================================================================

1.1 目的
------------------------------------------------------------------------
Amazonセラー向けのビジネスレポートCSVを分析し、商品パフォーマンスを可視化・評価する
Webツール。複数期間のデータを統合し、改善すべき商品や伸ばすべき商品を自動検出・分類
することで、効率的な広告投資・商品改善の意思決定を支援する。

1.2 システム構成
------------------------------------------------------------------------
- フロントエンド: HTML5 / CSS3 / JavaScript（Pure JS）
- ライブラリ:
  - Chart.js 4.4.1 (グラフ描画)
  - PapaParse 5.4.1 (CSV解析)
  - Lodash 4.17.21 (ユーティリティ)
- データ永続化: IndexedDB（ブラウザローカル）
- サーバーサイド: 不要（完全クライアントサイド処理）


================================================================================
2. 入力データ仕様
================================================================================

2.1 ファイル命名規則
------------------------------------------------------------------------
フォーマット: YYMMDD-YYMMDD-BusinessReport.csv

例:
  - 251101-251130-BusinessReport.csv  → 2025年11月1日〜11月30日
  - 251122-251220-BusinessReport.csv  → 2025年11月22日〜12月20日
  - 251130-251231-BusinessReport.csv  → 2025年11月30日〜12月31日

※ ファイル名から期間を自動解析する

2.2 CSVカラム構造
------------------------------------------------------------------------
| No | カラム名                   | 型     | 説明                         |
|----|---------------------------|--------|------------------------------|
| 1  | （親）ASIN                 | 文字列  | 親ASIN識別子                 |
| 2  | タイトル                    | 文字列  | 商品名                       |
| 3  | セッション数 - 合計         | 数値    | 商品ページ訪問数             |
| 4  | セッション率 - 合計         | %       | 全体に対するセッション率       |
| 5  | ページビュー - 合計         | 数値    | ページ表示回数               |
| 6  | ページビュー率 - 合計       | %       | 全体に対するPV率             |
| 7  | 注文された商品点数          | 数値    | 注文数量                     |
| 8  | ユニットセッション率         | %       | コンバージョン率(CVR)        |
| 9  | 注文商品の売上額            | 通貨    | 売上金額（￥表記）           |
| 10 | 注文品目総数                | 数値    | 注文品目数                   |
| 11 | 返金率                     | %       | 返金された割合               |

2.3 複数ファイル読み込み
------------------------------------------------------------------------
- 複数のCSVファイルを同時にアップロード可能
- 期間が重複する場合は、重複期間からセッション数等を日割り推定
- 重複排除にはファイルハッシュ（SHA-256）を使用

【追加要件】重複期間の推定（按分）と統合仕様
------------------------------------------------------------------------
1. 日割り計算 (Daily Calculation)
   - 各ファイルの指標（セッション数、売上等）を「期間合計」とみなし、日割り値を算出する
   - 計算式: `日次値 = 期間合計値 ÷ 期間日数`

2. 重複期間の解決 (Overlap Resolution)
   - 同一ASIN・同一日付に対して、複数のファイルからデータが得られる場合の優先順位：
     1. **期間（粒度）が短いファイルを優先** (例: 7日間レポート > 30日間レポート)
        - 理由: より短い期間のデータの方が、当該日の実態を正確に反映している可能性が高いため
     2. **期間が同じ場合は平均値**を採用
        - 例: 1週間ズレのレポート(1/1-1/7, 1/2-1/8)で重なる日(1/2-1/7)は、両者の日割り値を平均する

3. 統合データの構築
   - 上記ルールに基づき、ASINごとに「日次時系列データ」を生成・保持する
   - UI上の「月間」指標等は、この日次データを指定期間分（例: 直近30日）合計して算出する
   - 推定/按分を行った指標にはフラグを付与し、エクスポートで判別可能にする

2.4 数値フォーマット正規化【追加要件】
------------------------------------------------------------------------
CSV内の値は以下の表記揺れを許容し、数値へ正規化してから計算する。
- 3桁区切り: "1,153" → 1153
- 通貨: "￥29,040" → 29040
- パーセント: "10.13%" → 10.13（％値として保持）
- 空欄/欠損: "" → null（計算時は0扱い/除外のどちらかを指標ごとに定義）

正規化後の内部表現（推奨）
- sessions（整数）
- orders（整数）
- revenue（数値、JPY）
- unitSessionRatePct（数値、%）
- refundRatePct（数値、%）

2.5 CSV解析の注意点【追加要件】
------------------------------------------------------------------------
- タイトル列に改行が含まれる可能性があるため、CSVは「引用符付きフィールド」「改行を含むレコード」を許容して解析する
- ヘッダーが複数行に折り返されるケース（例: "ページビュー\n率 - 合計"）を許容し、列名は正規化マッピングで対応する
- 先頭/末尾の空白、不可視文字（全角スペース等）はトリムして比較する

2.6 補助マスタ（任意入力）【追加要件】
------------------------------------------------------------------------
Dev.txtの要件（出品後1ヶ月以内、アパレル判定）を満たすため、CSVに存在しない属性は任意で補助入力できる。

入力方式（いずれか/両方を許容）
- ASIN属性マスタCSV（推奨）
  - ファイル名例: asin-master.csv
  - カラム例: parentAsin, listingDate(YYYY-MM-DD), category(apparel/other)
- 手動設定（最小UI）
  - ASIN単位で listingDate と category を設定可能

未入力時の扱い
- listingDate 未入力: 本ツールでのデータ初出日（First Seen）を代替利用して「新規」判定を行う
- category 未入力: 「アパレルの必須CVR(3%)」の必須判定はスキップ（警告として表示）


================================================================================
3. 商品分類ロジック（コア要件）
================================================================================

3.1 基準値定義
------------------------------------------------------------------------
| 指標                 | 基準値           | 説明                           |
|---------------------|-----------------|--------------------------------|
| セッション数/月      | 200以上          | 良好：200以上、可：100以上、要改善：100未満   |
| 注文された商品点数/月 | 10以上           | 望ましい水準                    |
| 返金率（全体）       | 5%以下           | 商品全体での返金率目標          |
| ユニットセッション率  | 3%以上           | 通常：3%以上、良好：5%以上、絶好調：8%以上 |
| 客単価 (AOV)         | (モニタリング)    | クロスセル・アップセル施策の評価 |
| RPS (1訪問あたり売上) | 広告CPC以上      | 広告投資の採算性ライン           |

【追加要件】「月間」の定義（期間差の吸収）
------------------------------------------------------------------------
- ファイル期間が30日と限らないため、比較・判定に用いる "月間" は「直近30日換算」を基本とする
  - 直近30日のセッション数/注文点数/売上 = 日次系列の直近30日分の合算
  - 直近30日分が作れない場合は、取得できる日数分で算出し「推定精度不足」フラグを立てる

【追加要件】返金率（全体）の集計定義
------------------------------------------------------------------------
- 返金率は「個別ではなく商品全体」とあるため、全ASINを対象に集計した指標として算出し、全体ステータスとして表示する
- 集計方式: 注文点数で加重平均（顧客満足度重視）
  - 計算式: sum(orders * refundRatePct) / sum(orders)
- 全体返金率 > 5% の場合: 全体警告を表示（カテゴリ分類そのもののルールは変えない）

3.2 商品分類カテゴリ
------------------------------------------------------------------------

■ カテゴリA: 広告投入推奨（新規商品）
  条件: 出品後1ヶ月以内の商品
  推奨: 広告をかけてセッション数を伸ばす
  アクション: 積極的な広告投資

■ カテゴリB: 自力成長期待（安定商品）
  条件: 
    - セッション数 > 200
    - ユニットセッション率 3%以上 5%未満（通常水準）
  推奨: 広告を変えずに自力成長を見守る
  アクション: 現状維持、広告費抑制

■ カテゴリC: 広告強化推奨（高CVR商品）
  条件:
    - セッション数 > 200
    - ユニットセッション率 5%以上（良好・絶好調水準）
  推奨: 広告をかけてさらに伸ばす
  アクション: 積極的な広告投資

■ カテゴリD: 改善困難（低CVR商品）
  条件:
    - セッション数 ≥ 300
    - ユニットセッション率 1%未満（致命的な低CVR）
  推奨: 広告投資を控える、改善がほぼ不可能
  アクション: 広告停止、撤退検討

■ カテゴリE: セッション不足（露出不足）
  条件:
    - セッション数 < 100（月間）
  推奨: セッション数の改善が必要
  アクション: SEO改善、広告によるテスト露出

■ カテゴリF: 注文不足
  条件:
    - 注文された商品点数 < 10（月間）
    - セッション数は基準を満たしている
  推奨: 商品ページ改善、価格見直し
  アクション: リスティング最適化

■ カテゴリG: 高単価・機会損失（要CVR改善）
  条件:
    - 客単価(AOV) > 平均の1.5倍
    - ユニットセッション率 < 1%
    - セッション数 > 200
  推奨: クリエイティブ改善で利益最大化
  アクション: 商品画像・説明文の高品質化、レビュー対策

■ カテゴリH: 合わせ買い推奨（薄利多売傾向）
  条件:
    - 客単価(AOV) < 平均の0.5倍
    - ユニットセッション率 > 5%
  推奨: 客単価アップ施策
  アクション: まとめ買いキャンペーン、バンドル販売、「よく一緒に購入」対策

■ カテゴリI: 急落警戒（トレンド悪化）
  条件:
    - 直近期間のセッションまたは売上が、前期間比で30%以上減少
  推奨: 要因の早期特定と対策
  アクション: 競合調査、検索順位確認、在庫切れ確認、市場トレンド確認

■ カテゴリJ: 標準 / 監視対象
  条件: 上記のいずれのカテゴリにも該当しない
    - 例: CVRが1%以上3%未満の商品（要改善だが致命的ではない）
    - 例: セッション数が100〜200の商品（可）
  推奨: 定期的なモニタリングと個別改善
  アクション: 現状維持、または部分的な改善施策のテスト

■ カテゴリK: 販売継続（基準クリア）
  条件:
    - セッション数 > 100
    - ユニットセッション率 3%以上
    ※ カテゴリB/C（セッション200以上）には届かないが、基準はクリアしている層
  推奨: 販売継続
  アクション: 在庫維持、安定運用

3.3 分類優先度
------------------------------------------------------------------------
※ 1商品につき、最も優先度の高いカテゴリを1つだけ適用する（排他分類）。

1. カテゴリI（急落警戒）を最優先で検出 → リスク管理
2. カテゴリD（改善困難）を検出 → コスト削減
3. カテゴリG（高単価機会損失）を検出 → 利益改善インパクト大
4. カテゴリC（高CVR）を検出 → 成長加速
5. カテゴリA（新規）を検出 → 初動対応
6. カテゴリH（合わせ買い）/ B（安定） → 順次対応
7. カテゴリK（販売継続） → 安定運用
8. カテゴリE・F（改善） → 対策検討

3.4 収益性・効率性指標（追加提案）
------------------------------------------------------------------------
売上最大化と広告効率化のため、以下の指標もモニタリング対象とする。

■ 客単価 (AOV: Average Order Value)
  - 計算式: 注文商品の売上額 ÷ 注文された商品点数
  - 目的: セット販売（まとめ買い）や高単価商品の販売効率を測る
  - アクション: AOVが低い商品は「よく一緒に購入されている商品」対策やバンドル販売を検討

■ セッションあたり売上 (RPS: Revenue Per Session)
  - 計算式: 注文商品の売上額 ÷ セッション数
  - 目的: 1アクセスあたりの収益性を可視化し、広告の許容CPC（クリック単価）を判断する
  - 基準: RPS > 想定CPC であることが広告出稿の最低条件（ROAS > 100%の目安）
  - アクション: 高RPS商品は積極的に広告入札単価を引き上げ、露出を最大化する


================================================================================
4. 機能要件
================================================================================

4.1 ファイルアップロード機能
------------------------------------------------------------------------
- ドラッグ＆ドロップ対応
- 複数ファイル同時アップロード
- ファイル重複チェック（SHA-256ハッシュ）
- アップロード履歴管理（IndexedDB保存）

4.2 データ処理機能
------------------------------------------------------------------------
- CSV解析（PapaParse使用）
- 期間重複の検出と日割り推定
- 親ASINベースでのデータ統合
- 時系列データの構築

【追加要件】データ品質チェック
------------------------------------------------------------------------
- 必須キー（親ASIN）が欠損の行は除外し、除外件数をサマリー表示/エクスポート
- sessions=0 で unitSessionRatePct>0 など、矛盾値は補正または警告（補正方針は実装時に確定）
- すべての正規化/補正/除外は監査可能な形で記録（エクスポートに含める）

4.3 商品分類・検出機能【新規実装】
------------------------------------------------------------------------
- 3.2で定義した分類カテゴリへの自動分類
- 分類結果の一覧表示
- 分類根拠の表示（該当条件の明示）
- カテゴリ別フィルタリング

【追加要件】分類の根拠（説明）に含める項目
------------------------------------------------------------------------
- 判定に使った期間（直近30日/任意ウィンドウ）
- sessions / orders / unitSessionRatePct の実数値
- listingDate と商品カテゴリ（入力されている場合）
- 推定（按分）フラグの有無

4.4 可視化機能
------------------------------------------------------------------------
- ASINモニタリング（ダッシュボード）
  - 商品別パフォーマンス一覧（ソート・フィルタ機能付き）
  - スパークライン表示（直近のトレンドをミニグラフで一覧表示）
  - カテゴリ別カラーコーディング（ヒートマップ風表示）

- パフォーマンスマトリックス（散布図）
  - X軸：セッション数、Y軸：ユニットセッション率（CVR）
  - バブルサイズ：売上または注文数
  - 4象限分析による視覚的な問題児・スター商品の発見

- 時系列分析（詳細グラフ）
  - 複合グラフ：セッション数（棒）とCVR（折れ線）の同時表示
  - 期間比較：前期間 vs 当期間の重ね合わせ表示
  - 移動平均線（7日/30日）によるトレンド平滑化

- カテゴリ構成分析
  - カテゴリ別商品数・売上構成比の円グラフ/棒グラフ
  - カテゴリごとの平均パフォーマンス比較

- 異常検知・ランキング
  - 急上昇・急落ランキング（変化率ベース）
  - パレート分析（売上貢献度ABC分析）

4.5 レポート機能
------------------------------------------------------------------------
- 分析結果エクスポート（JSON/CSV）
- 商品分類サマリー
- アクション推奨リスト

【追加要件】エクスポートに含めるべき項目
------------------------------------------------------------------------
- ASINごとの統合指標（直近30日換算）と、元ファイル期間の一覧
- 推定/按分の有無、除外行数、警告（欠損・矛盾）
- 全体返金率（集計方式A/Bの明記）

4.6 データ管理機能
------------------------------------------------------------------------
- IndexedDBへのデータ永続化
- データクリア機能
- アップロード履歴の表示・削除

4.7 複数期間データ活用と自動最適化【新規】
------------------------------------------------------------------------
複数期間のファイルがアップロードされた場合、単一期間の分析だけでなく、時系列データを活用した自動最適化を行う。

1. 動的閾値調整 (Dynamic Thresholds)
   - 全期間の平均値や標準偏差を算出し、固定閾値（セッション100等）を補正する
   - 例: 全体的にアクセスが少ない時期は、判定基準を相対的に下げる

2. トレンドベース判定
   - 単月の数値だけでなく、移動平均線（短期・長期）のクロスや傾きを判定に利用
   - 「数値は低いが上昇トレンド」の商品は、即座に「改善困難」とせず「要監視」とする

3. 季節性（Seasonality）の考慮
   - キーワードによる自動属性判定（アパレル特化）
     - 春夏（SS）: タイトルに「春」「夏」「SS」「半袖」「サマー」等が含まれる場合
     - 秋冬（AW）: タイトルに「秋」「冬」「AW」「長袖」「ウインター」等が含まれる場合
     - 通年: 「通年」「オールシーズン」が含まれる、または上記いずれにも該当しない場合
   - 季節属性に基づく判定ロジックの補正
     - シーズンオフ期間（例: SS商品の冬期）の売上減少は「急落警戒（カテゴリI）」の対象外、または閾値を緩和する
     - 前年同月データがある場合は、前年比成長率（YoY）を優先して評価する
   - 属性の手動オーバーライド
     - 自動判定結果をUI上で確認・修正し、固定設定として保存可能にする

4. 欠損データの自動補完 (Missing Data Interpolation)
   - データの連続性を保つため、以下のロジックで欠損日を補完する
   - **線形補間 (Linear Interpolation)**
     - 条件: 欠損期間が「7日以内」であり、その前後に有効なデータが存在する場合
     - 計算式: `y = y1 + (y2 - y1) * (x - x1) / (x2 - x1)`
     - 目的: グラフの断絶を防ぎ、トレンド分析の精度を維持する
   - **除外処理**
     - 欠損期間が8日以上の場合は補完を行わず、「データなし」として扱う（グラフは不連続となる）


================================================================================
5. 画面仕様
================================================================================

5.1 メイン画面構成
------------------------------------------------------------------------
┌─────────────────────────────────────────────────────────┐
│ ヘッダー: Amazon ASIN Performance Tracker              │
├─────────────────────────────────────────────────────────┤
│ ファイルアップロードエリア                               │
│ ┌─────────────────────────────────────────────────┐    │
│ │  📁 CSVファイルをドラッグ＆ドロップ              │    │
│ └─────────────────────────────────────────────────┘    │
│ [💾 エクスポート] [📋 履歴] [🗑️ クリア]              │
├─────────────────────────────────────────────────────────┤
│ 統計サマリー (4カード)                                  │
│ ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐                   │
│ │総売上 │ │ASIN数│ │新規  │ │成長率│                   │
│ └──────┘ └──────┘ └──────┘ └──────┘                   │
├─────────────────────────────────────────────────────────┤
│ ビュー切替タブ                                          │
│ [ASINモニタリング][時系列分析][異常検知][新商品][詳細]  │
│ 【新規】[商品分類]                                       │
├─────────────────────────────────────────────────────────┤
│ コンテンツエリア                                         │
│ (選択したビューに応じた表示)                            │
└─────────────────────────────────────────────────────────┘

5.2 商品分類ビュー【新規】
------------------------------------------------------------------------
- カテゴリ別タブまたはフィルタ
- 分類された商品の一覧表示
- 各商品に対する推奨アクションの表示
- カテゴリ別の商品数サマリー


================================================================================
6. 非機能要件
================================================================================

6.1 パフォーマンス
------------------------------------------------------------------------
- 1000行以上のCSVでも3秒以内に処理完了
- グラフ描画は2秒以内
- ブラウザメモリ使用量は500MB以下

6.2 対応ブラウザ
------------------------------------------------------------------------
- Google Chrome (最新版)
- Mozilla Firefox (最新版)
- Microsoft Edge (最新版)
- Safari (最新版)

6.3 セキュリティ
------------------------------------------------------------------------
- すべての処理はクライアントサイドで完結
- データはローカルのIndexedDBのみに保存
- 外部サーバーへのデータ送信なし

6.4 ユーザビリティ
------------------------------------------------------------------------
- レスポンシブデザイン対応
- 直感的なドラッグ＆ドロップ操作
- エラー時の明確なフィードバック

【追加要件】推定値に関する注意表示
------------------------------------------------------------------------
- 期間重複の按分や「直近30日換算」により推定を行った場合、UI上で「推定」ラベルを表示
- 推定の信頼性が低い（推定精度が低い）と判断される場合（例: 直近30日のうち推定日数が半数超）は、その旨（「精度低」等の警告）を明示的に表示する


================================================================================
7. 今後の拡張予定
================================================================================

7.1 Phase 2 検討事項
------------------------------------------------------------------------
- 出品日情報の取得方法の検討（現状CSVに含まれない）
- 商品カテゴリ（アパレル等）の識別方法
- アラート通知機能の強化
- レポートのPDF出力機能

【追加検討】閾値のカスタマイズ
------------------------------------------------------------------------
- sessions=100, orders=10, CVR閾値（2-3%, 5%等）は、運用により変わるため設定値として変更可能にする
  - 最小実装: script内の定数として一元管理
  - UI化はPhase 2

7.2 データ連携
------------------------------------------------------------------------
- Amazon SP-API連携の検討
- 広告レポートとの統合


================================================================================
8. 用語定義
================================================================================

| 用語                    | 定義                                         |
|------------------------|----------------------------------------------|
| ASIN                   | Amazon Standard Identification Number        |
| セッション             | 商品詳細ページへの訪問（24時間内は1カウント）  |
| ユニットセッション率    | 注文数 ÷ セッション数 × 100（CVR）           |
| CVR                    | Conversion Rate（コンバージョン率）           |
| 返金率                  | 返金数 ÷ 注文数 × 100                        |


================================================================================
9. 分類ロジック実装例（疑似コード）
================================================================================

```javascript
function classifyProduct(product, monthlyData, comparisonData) {
  const { sessions, unitSessionRate, orders, listingAge, aov, revenue } = product;
  const avgAov = monthlyData.avgAov; // 全体平均客単価
  
  // カテゴリI: 急落警戒（トレンド悪化）
  // 直近期間の売上が前期間比30%以上ダウン
  if (comparisonData && comparisonData.revenueChangeRate <= -30) {
    return {
      category: 'I',
      name: '急落警戒（トレンド悪化）',
      action: '要因の早期特定と対策（競合・在庫・検索順位）',
      priority: 1
    };
  }

  // カテゴリD: 改善困難（高セッション・低CVR）
  if (sessions >= 300 && unitSessionRate <= 1) {
    return {
      category: 'D',
      name: '改善困難（低CVR商品）',
      action: '広告停止を推奨、撤退検討',
      priority: 2
    };
  }
  
  // カテゴリG: 高単価・機会損失
  if (aov > avgAov * 1.5 && unitSessionRate < 1 && sessions > 200) {
    return {
      category: 'G',
      name: '高単価・機会損失（要CVR改善）',
      action: 'クリエイティブ改善で利益最大化',
      priority: 3
    };
  }

  // カテゴリC: 広告強化推奨（高CVR商品）
  if (sessions > 200 && unitSessionRate >= 5) {
    return {
      category: 'C',
      name: '広告強化推奨（高CVR商品）',
      action: '広告をかけてさらに伸ばす',
      priority: 4
    };
  }
  
  // カテゴリA: 新規商品（出品1ヶ月以内）
  if (listingAge <= 30) {
    return {
      category: 'A',
      name: '広告投入推奨（新規商品）',
      action: '広告をかけてセッション数を伸ばす',
      priority: 5
    };
  }
  
  // カテゴリH: 合わせ買い推奨
  if (aov < avgAov * 0.5 && unitSessionRate > 5) {
    return {
      category: 'H',
      name: '合わせ買い推奨（薄利多売傾向）',
      action: 'まとめ買いキャンペーン、バンドル販売',
      priority: 6
    };
  }
  
  // カテゴリB: 自力成長期待（安定商品）
  if (sessions > 200 && unitSessionRate >= 3 && unitSessionRate < 5) {
    return {
      category: 'B',
      name: '自力成長期待（安定商品）',
      action: '広告を変えずに自力成長を見守る',
      priority: 7
    };
  }

  // カテゴリK: 販売継続（基準クリア）
  if (sessions > 100 && unitSessionRate >= 3) {
    return {
      category: 'K',
      name: '販売継続（基準クリア）',
      action: '在庫維持、安定運用',
      priority: 8
    };
  }
  
  // カテゴリE: セッション不足
  if (sessions < 100) {
    return {
      category: 'E',
      name: 'セッション不足（露出不足）',
      action: 'SEO改善、広告によるテスト露出',
      priority: 8
    };
  }
  
  // カテゴリF: 注文不足
  if (orders < 10) {
    return {
      category: 'F',
      name: '注文不足',
      action: 'リスティング最適化、価格見直し',
      priority: 8
    };
  }
  
  // その他
  return {
    category: 'J',
    name: '標準',
    action: '継続モニタリング',
    priority: 9
  };
}
```


================================================================================
10. 変更履歴
================================================================================

| 日付       | バージョン | 変更内容                                    |
|------------|-----------|---------------------------------------------|
| 2026/01/02 | 1.0       | 初版作成                                    |
| 2026/01/02 | 1.1       | カテゴリG/H/I追加、複数期間データ活用機能追加 |
| 2026/01/02 | 1.2       | 良好基準をセッション200以上に変更           |
| 2026/01/02 | 1.3       | カテゴリJ追加、優先度ルール・未入力時挙動の明記 |
| 2026/01/02 | 1.4       | 推定精度が低い場合の警告表示要件を明確化     |
| 2026/01/02 | 1.5       | ユニットセッション率の基準定義を更新（通常/良好/絶好調） |
| 2026/01/02 | 1.6       | カテゴリB/C/D/JのCVR基準を明確化、返金率集計方式を確定 |
| 2026/01/02 | 1.7       | カテゴリBを「販売継続」に変更（セッション>100, CVR>=3%） |
| 2026/01/02 | 1.8       | カテゴリBを復元し、カテゴリK（販売継続）を新規追加       |
| 2026/01/02 | 1.9       | 可視化機能（マトリックス、複合グラフ等）の詳細化     |
| 2026/01/02 | 1.10      | 季節性（Seasonality）判定ロジック（キーワード判定・手動補正）を追加 |


================================================================================
プロジェクト構成
================================================================================

## ディレクトリ構造

```
webtool-ec-performance-analysis-amazon/
├── index.html              # メインHTML（静的環境対応版）
├── README.md               # プロジェクト説明（このファイル）
├── bug_report.txt          # バグ修正レポート
├── css/
│   └── styles.css          # スタイルシート
├── js/
│   ├── create-bundle.js    # バンドル生成スクリプト
│   ├── bundle-static.js    # 本番用バンドルファイル（これを使用）
│   ├── config.js           # 設定値（開発用）
│   ├── utils.js            # ユーティリティ関数（開発用）
│   ├── db.js               # IndexedDB操作（開発用）
│   ├── data.js             # データ処理（開発用）
│   ├── charts.js           # グラフ描画（開発用）
│   ├── ui.js               # UI更新（開発用）
│   └── main.js             # メイン処理（開発用）
└── *.csv                   # サンプルデータファイル
```

## ファイルの役割

### 本番環境（エンドユーザー向け）
- **index.html**: `<script src="js/bundle-static.js"></script>` を使用
- **js/bundle-static.js**: すべてのJSコードを統合したファイル（88KB）
- **静的環境（file://）で動作**: HTMLをダブルクリックするだけで使用可能

### 開発環境
- **js/*.js（個別ファイル）**: コードを機能ごとに分割
- **js/create-bundle.js**: 個別ファイルをbundle-static.jsに結合するスクリプト
- **開発時のワークフロー**:
  1. js/*.js ファイルを編集
  2. `node js/create-bundle.js` でバンドル再生成
  3. ブラウザでindex.htmlをリロード

## 使用方法

### エンドユーザー
1. index.htmlをダブルクリック
2. CSVファイルをドラッグ＆ドロップ
3. 分析開始

### 開発者
1. コード変更: `js/main.js` など個別ファイルを編集
2. バンドル生成: `node js/create-bundle.js`
3. 動作確認: index.htmlをリロード

## 技術スタック
- Vanilla JavaScript（フレームワーク不使用）
- Chart.js 4.4.1（グラフ描画）
- PapaParse 5.4.1（CSV解析）
- Lodash 4.17.21（ユーティリティ）
- IndexedDB（ブラウザ内データベース）

## 静的環境対応について
- ESモジュール（import/export）を使用せず、すべてのJSを1つのバンドルファイルに統合
- file://プロトコルでも動作するため、Webサーバー不要
- 詳細はbug_report.txtを参照


================================================================================
End of Document
================================================================================

