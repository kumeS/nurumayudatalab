<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CiLEL 購入履歴ビューア</title>
  <meta name="referrer" content="no-referrer">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: blob:; connect-src 'self'; frame-ancestors 'none'; form-action 'self';">
  <link rel="icon" href="../favicon/nu-circle.svg" type="image/svg+xml">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 16V8C20.9996 7.64927 20.9044 7.30481 20.7231 7.00106C20.5418 6.69732 20.2806 6.44477 19.965 6.27L12.965 2.27C12.669 2.1009 12.336 2.01172 12 2.01172C11.664 2.01172 11.331 2.1009 11.035 2.27L4.035 6.27C3.71936 6.44477 3.45816 6.69732 3.27688 7.00106C3.0956 7.30481 3.00042 7.64927 3 8V16C3.00042 16.3507 3.0956 16.6952 3.27688 16.9989C3.45816 17.3027 3.71936 17.5552 4.035 17.73L11.035 21.73C11.331 21.8991 11.664 21.9883 12 21.9883C12.336 21.9883 12.669 21.8991 12.965 21.73L19.965 17.73C20.2806 17.5552 20.5418 17.3027 20.7231 16.9989C20.9044 16.6952 20.9996 16.3507 21 16Z" stroke="url(#header_icon_gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M3.27002 6.96002L12 12.01L20.73 6.96002" stroke="url(#header_icon_gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 22.08V12" stroke="url(#header_icon_gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <defs>
            <linearGradient id="header_icon_gradient" x1="3" y1="22" x2="21" y2="2" gradientUnits="userSpaceOnUse">
              <stop stop-color="#ff9966"/>
              <stop offset="1" stop-color="#ff5e62"/>
            </linearGradient>
          </defs>
        </svg>
        仕入商品の購入履歴ビューア(CiLELオーダー用) v2
      </h1>
      <p class="subtitle">CiLELの注文シート（XLSX）を読み込み、商品情報を一覧表示できるビューアです</p>
      <div class="info-notice">
        <span class="info-text"><strong>使い方：</strong><a href="https://www.cilel.jp/" target="_blank" rel="noopener noreferrer">CiLEL商品発注ページ</a>から注文Excelファイルをダウンロードし、このビューアにアップロードしてください。</span>
      </div>
    </div>
    
    <div class="upload-area">
      <div class="upload-zone" id="dropZone">
        <div class="upload-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 16V4" stroke="url(#upload_gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M8 8L12 4L16 8" stroke="url(#upload_gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M20 16V20H4V16" stroke="url(#upload_gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <defs>
              <linearGradient id="upload_gradient" x1="4" y1="20" x2="20" y2="4" gradientUnits="userSpaceOnUse">
                <stop stop-color="#ff9966"/>
                <stop offset="1" stop-color="#ff5e62"/>
              </linearGradient>
            </defs>
          </svg>
        </div>
        <div class="upload-text">XLSXファイルをドラッグ&ドロップ</div>
        <div class="upload-subtext">または クリックしてファイルを選択（複数対応）</div>
        <div class="upload-note">※ 一度に20ファイル程度までの読み込みを推奨しています。それ以上はブラウザ性能に依存します。</div>
        <input type="file" id="fileInput" multiple accept=".xlsx,.xls">
      </div>
    </div>
    
    <div class="tabs" id="tabs"></div>
    <div id="orderInfo"></div>
    <div class="stats" id="stats"></div>
    <div class="tab-controls">
      <label>商品表示順:
        <select id="productSortMode">
          <option value="default">エクセルと同じ順</option>
          <option value="subtotal-desc">購入金額が高い順</option>
          <option value="subtotal-asc">購入金額が低い順</option>
          <option value="ship-desc">出荷数量が多い順</option>
          <option value="ship-asc">出荷数量が少ない順</option>
          <option value="domestic-desc">中国内送料が高い順</option>
          <option value="url-asc">商品ページのURL順</option>
        </select>
      </label>
    </div>
    <div class="product-grid" id="productGrid"></div>
  </div>

  <div id="statusPopup" class="status-popup hidden"></div>
  <script src="js/app-utils.js"></script>
  <script src="js/app-state-core.js"></script>
  <script src="js/app-state-extra.js"></script>
  <script src="js/app-render.js"></script>
  <script src="js/app-helpers.js"></script>
  <script src="js/app-file-input.js"></script>
</body>
</html>
