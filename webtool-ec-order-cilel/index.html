<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CiLEL 購入履歴ビューア</title>
  <meta name="referrer" content="no-referrer">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: blob:; connect-src 'self'; frame-ancestors 'none'; form-action 'self';">
  <link rel="icon" href="../favicon/nu-circle.svg" type="image/svg+xml">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>📦 仕入商品の購入履歴ビューア(CiLELオーダー用)</h1>
      <p class="subtitle">CiLELの注文シート（XLSX）を読み込み、商品情報を一覧表示できるビューアです</p>
      <div class="info-notice">
        <span class="info-icon">ℹ️</span>
        <span class="info-text"><strong>使い方：</strong><a href="https://www.cilel.jp/" target="_blank" rel="noopener noreferrer">CiLEL商品発注ページ</a>から注文Excelファイルをダウンロードし、このビューアにアップロードしてください。</span>
      </div>
    </div>
    
    <div class="upload-area">
      <div class="upload-zone" id="dropZone">
        <span class="upload-icon">📁</span>
        <p class="upload-text">XLSXファイルをドラッグ＆ドロップ</p>
        <p class="upload-subtext">または クリックしてファイルを選択（複数対応）</p>
        <p class="upload-note">※ 一度に20ファイル程度までの読み込みを推奨しています。それ以上はブラウザ性能に依存します。</p>
        <input type="file" id="fileInput" multiple accept=".xlsx,.xls">
      </div>
    </div>
    
    <div class="tabs" id="tabs"></div>
    <div id="orderInfo"></div>
    <div class="stats" id="stats"></div>
    <div class="tab-controls">
      <label>商品表示順:
        <select id="productSortMode">
          <option value="default">エクセルと同じ順</option>
          <option value="subtotal-desc">購入金額が高い順</option>
          <option value="subtotal-asc">購入金額が低い順</option>
          <option value="ship-desc">出荷数量が多い順</option>
          <option value="ship-asc">出荷数量が少ない順</option>
          <option value="domestic-desc">中国内送料が高い順</option>
        </select>
      </label>
    </div>
    <div class="product-grid" id="productGrid"></div>
  </div>

  <div id="statusPopup" class="status-popup hidden"></div>
  <script src="js/app-utils.js"></script>
  <script src="js/app-state-core.js"></script>
  <script src="js/app-state-extra.js"></script>
  <script src="js/app-render.js"></script>
  <script src="js/app-helpers.js"></script>
  <script src="js/app-file-input.js"></script>
</body>
</html>
