# ぬるっと翻訳・校閲ツール

LLMを活用したテキスト処理ツールです。日本語と英語間の翻訳、および日本語と英語の文章校閲機能を提供します。

## 概要

このツールは、Cloudflare Workers上で動作するLLM (Large Language Model) APIを利用して、以下のテキスト処理機能を実現します。

- **日本語 → 英語翻訳**: 入力された日本語テキストを英語に翻訳します。
- **英語 → 日本語翻訳**: 入力された英語テキストを日本語に翻訳します。
- **日本語校閲**: 入力された日本語テキストを校閲し、改善案と解説を表示します。
- **英語校閲**: 入力された英語テキストを校閲し、改善案と解説（日本語）を表示します。

ウェブインターフェースを通じて、ユーザーは簡単に対象のテキストを入力し、処理結果を確認できます。

## 主な機能

- **4つの処理モード**:
    - 日本語→英語翻訳
    - 英語→日本語翻訳
    - 日本語校閲
    - 英語校閲
- **直感的なUI**:
    - タブによるモード切り替え
    - 入力テキストエリア
    - 処理結果表示エリア（校閲結果と最終テキストを分けて表示）
    - 実行、クリア、コピー、入力欄に戻すボタン
- **入力テキストの自動保存**: ブラウザのローカルストレージに入力内容を保存し、リロード後も復元します。
- **ローディング表示**: LLM処理中の待ち時間を視覚的に示します。
- **校閲結果の保護**: 校閲コメント部分はコピーできないように制御されています。
- **レスポンシブデザイン**: 様々な画面サイズに対応します。
- **使い方ガイド**: アコーディオン形式でツールの使用方法を表示・非表示できます。

## 使い方

1.  **モード選択**: ページ上部のタブから、実行したい処理モード（「日本語→英語」「英語→日本語」「日本語校閲」「英語校閲」）を選択します。
2.  **テキスト入力**: 中央のテキストエリアに処理したいテキストを入力します。
3.  **実行**: 「実行」ボタンをクリックすると、LLMによる処理が開始されます。
4.  **結果確認**:
    *   **校閲結果**: 校閲モードの場合、校閲コメントや修正点がここに表示されます（コピー不可）。
    *   **最終結果**: 翻訳結果または校閲後の最終テキストがここに表示されます。「コピー」ボタンで内容をクリップボードにコピーしたり、「入力欄に戻す」ボタンでこの内容を入力エリアに転送したりできます。

## 技術スタック

-   **フロントエンド**:
    -   HTML5
    -   CSS3 (Flexbox, CSS Variables, Animations)
    -   Vanilla JavaScript (ES6+)
    -   Font Awesome (アイコン)
-   **バックエンド/LLM API**:
    -   Cloudflare Workers (`nurumayu-worker.skume-bioinfo.workers.dev`)
    -   使用モデル: `meta-llama/Llama-4-Maverick-17B-128E-Instruct-FP8` (現在は固定)
-   **API通信**:
    -   非ストリーミング HTTP POSTリクエスト (JSON)
    -   当初はストリーミング (Server-Sent Events) を検討していましたが、現在は非ストリーミングモードで動作しています。

## ファイル構成

-   `index.html`: ウェブページの構造を定義します。スタイルシートもこのファイル内に記述されています。
-   `app.js`: ウェブページのインタラクション、UI制御、LLM APIとの通信など、主要なクライアントサイドロジックを実装しています。
-   `plan.txt`: プロジェクトの初期計画、設計思想、実装ステップ、プロンプト案などが記載されたドキュメントです。
-   `workertest.sh`: Cloudflare Workerのエンドポイントに対してストリーミングリクエストをテストするためのシェルスクリプトです。

## 開発経緯 (plan.txtより推測)

`plan.txt` の内容から、このツールは以下のステップで開発が進められたと推測されます。

1.  **基本構想**: LLMを利用した翻訳・校閲ツールのアイデア。
2.  **UI設計**: HTML/CSSでの基本的なインターフェース作成。
3.  **コア機能実装**: JavaScriptでのタブ切り替え、API呼び出し、結果表示。
4.  **LLM連携**: Cloudflare Worker経由でのLLM API接続とプロンプト設計。
5.  **機能改善**: ストリーミング対応（初期計画）、入力保存、UI/UX向上、エラーハンドリング。

当初はストリーミングAPIでの実装が計画されていましたが、`app.js` 内のコメントによると、問題が発生したため非ストリーミングモードに切り替えられたようです。
`workertest.sh` は、ストリーミングAPIのテストに使用されていたと考えられます。

## 今後の拡張可能性 (plan.txtより)

-   多言語対応
-   カスタムプロンプト設定
-   ユーザー設定保存
-   履歴機能
-   エクスポート機能 (PDFなど)
-   音声入力対応 