<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>児童進捗管理ツール｜Kids Progress Manager</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/main.css">
</head>
<body>
  <div class="container">
    <!-- ヘッダー -->
    <header class="header">
      <h1><i class="fas fa-child"></i> 児童進捗管理ツール</h1>
      <p class="subtitle">Kids Progress Manager - 教育現場での進捗管理とAI分析支援</p>
    </header>

    <!-- タブナビゲーション -->
    <div class="tabs">
      <button class="tab" data-tab="students" data-action="switch-tab" data-target="students">
        <i class="fas fa-users"></i> 児童管理
      </button>
      <button class="tab" data-tab="input" data-action="switch-tab" data-target="input">
        <i class="fas fa-edit"></i> 進捗データ入力
      </button>
      <button class="tab" data-tab="overview" data-action="switch-tab" data-target="overview">
        <i class="fas fa-chart-line"></i> 進捗管理
      </button>
      <button class="tab" data-tab="analysis" data-action="switch-tab" data-target="analysis">
        <i class="fas fa-brain"></i> AI分析
      </button>
      <button class="tab" data-tab="settings" data-action="switch-tab" data-target="settings">
        <i class="fas fa-cog"></i> 設定
      </button>
      <button class="tab" data-tab="system-overview" data-action="switch-tab" data-target="system-overview">
        <i class="fas fa-info-circle"></i> システム概要
      </button>
    </div>

    <!-- メインコンテンツ -->
    <div class="main-content">
      <!-- サイドバー -->
      <aside class="sidebar">
        <!-- 検索機能 -->
        <div class="sidebar-section">
          <h3 class="sidebar-title">
            <i class="fas fa-search"></i> 検索・フィルター
          </h3>
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="studentSearch" class="form-input" placeholder="児童名で検索...">
          </div>
          <div class="form-group">
            <label class="form-label">学年フィルター</label>
            <select id="gradeFilter" class="form-select">
              <option value="">すべて</option>
              <option value="1">1年生</option>
              <option value="2">2年生</option>
              <option value="3">3年生</option>
              <option value="4">4年生</option>
              <option value="5">5年生</option>
              <option value="6">6年生</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">クラスフィルター</label>
            <select id="classFilter" class="form-select">
              <option value="">すべて</option>
            </select>
          </div>
        </div>

        <!-- クイックアクション -->
        <div class="sidebar-section">
          <h3 class="sidebar-title">
            <i class="fas fa-lightning-bolt"></i> クイックアクション
          </h3>
          <button class="btn btn-primary" class="btn-full-width" data-action="open-modal" data-target="addStudentModal">
            <i class="fas fa-user-plus"></i> 児童追加
          </button>
        </div>

        <!-- データ統計 -->
        <div class="sidebar-section">
          <h3 class="sidebar-title">
            <i class="fas fa-chart-bar"></i> データ統計
          </h3>
          <div class="card" class="m-0-simple">
            <div class="flex justify-between">
              <span>登録児童数</span>
              <strong id="totalStudents">0</strong>
            </div>
            <div class="flex justify-between">
              <span>今日の入力</span>
              <strong id="todayInputs">0</strong>
            </div>
            <div class="flex justify-between cursor-pointer" data-action="toggle-detail">
              <span>未入力項目</span>
              <div class="flex-center-gap">
                <strong id="missingInputs">0</strong>
                <i id="missingInputsToggle" class="fas fa-chevron-down text-xs-secondary-transition"></i>
              </div>
            </div>
            <div class="flex justify-between">
              <span>入力が滞っている児童</span>
              <strong id="noRecentInputCount" class="text-error">0</strong>
            </div>
            
            <!-- 未入力項目の詳細表示 -->
            <div id="missingInputsDetail" class="hidden mt-1-border-top">
              <div class="mb-half-simple">
                <h4 class="text-primary-flex-center-gap">
                  <i class="fas fa-exclamation-circle" class="color-warning"></i>
                  未入力の児童
                </h4>
              </div>
              <div id="missingInputsList" class="max-h-200">
                <!-- 動的に生成される未入力児童リスト -->
              </div>
              
              <!-- 入力が滞っている児童セクション -->
              <div id="noRecentInputSection" class="mt-1-border-top">
                <div class="mb-half-simple">
                  <h4 class="text-primary-flex-center-gap">
                    <i class="fas fa-clock" class="text-error"></i>
                    入力が滞っている児童
                  </h4>
                  <p class="text-secondary-xs-mt">
                    3日以上データ入力がない児童
                  </p>
                </div>
                <div id="noRecentInputsList" class="max-h-200">
                  <!-- 動的に生成される入力が滞っている児童リスト -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <!-- メインエリア -->
      <main class="content-area">
        <!-- 児童管理タブ -->
        <div id="students-tab" class="tab-content hidden">
          <div class="flex justify-between items-center mb-2">
            <h2 class="card-title">児童管理</h2>
            <div class="flex gap-2">
              <button class="btn btn-primary" data-action="open-modal" data-target="addStudentModal">
                <i class="fas fa-user-plus"></i> 新規追加
              </button>
              <button class="btn btn-secondary" data-action="refresh-table">
                <i class="fas fa-sync-alt"></i> 更新
              </button>
            </div>
          </div>
          
          <div class="data-table-container">
            <table class="data-table" id="studentsTable">
              <thead>
                <tr>
                  <th>氏名</th>
                  <th>在籍番号</th>
                  <th>学年</th>
                  <th>性別</th>
                  <th>クラス</th>
                  <th>登録日</th>
                  <th>データ数</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody id="studentsTableBody">
                <!-- データは動的に生成 -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- データ入力タブ -->
        <div id="input-tab" class="tab-content hidden">
          <h2 class="card-title">進捗データ入力</h2>
          
          <div class="card">
            <form id="progressInputForm">
              <div class="form-group">
                <label class="form-label">児童選択</label>
                <select id="studentSelect" class="form-select" required>
                  <option value="">児童を選択してください</option>
                </select>
              </div>
              
              <div id="inputFields">
                <!-- 動的に生成される入力フィールド -->
              </div>
              
              <div class="form-group">
                <label class="form-label">備考・メモ</label>
                <textarea id="notesInput" class="form-input" rows="3" placeholder="気づいたことや特記事項を入力..."></textarea>
              </div>
              
              <div class="flex gap-2">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> 保存
                </button>
                <button type="button" class="btn btn-secondary" data-action="clear-form">
                  <i class="fas fa-eraser"></i> クリア
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- 進捗管理タブ -->
        <div id="overview-tab" class="tab-content hidden">
          <div class="flex justify-between items-center mb-2">
            <h2 class="card-title">児童進捗管理</h2>
            <div class="flex gap-2">
              <button class="btn btn-primary" data-action="switch-tab" data-target="input">
                <i class="fas fa-plus"></i> 進捗入力
              </button>
              <button class="btn btn-secondary" data-action="refresh-table">
                <i class="fas fa-sync-alt"></i> 更新
              </button>
              <button class="btn btn-success" data-action="export-data">
                <i class="fas fa-download"></i> エクスポート
              </button>
            </div>
          </div>
          
          <!-- データテーブル -->
          <div class="card" class="overflow-auto-custom">
            <div class="p-top-only">
              <div class="flex justify-between items-center mb-2">
                <h3 class="text-primary-lg-header">
                  <i class="fas fa-table"></i> 進捗管理一覧
                </h3>
                <div class="flex gap-2">
                  <button class="btn btn-secondary" data-action="filter-table" data-filter="all" class="form-small">
                    <i class="fas fa-list"></i> 全て
                  </button>
                  <button class="btn btn-warning" data-action="filter-table" data-filter="attention" class="form-small">
                    <i class="fas fa-exclamation-triangle"></i> 要注意
                  </button>
                  <button class="btn btn-success" data-action="filter-table" data-filter="good" class="form-small">
                    <i class="fas fa-thumbs-up"></i> 良好
                  </button>
                </div>
              </div>
            </div>
            <div class="data-table-container" class="modal-scroll">
              <table class="data-table" id="progressTable">
              <thead id="progressTableHead">
                <tr>
                    <th class="sticky-left">氏名</th>
                    <th class="min-w-100">在籍番号</th>
                    <th class="min-w-80">学年</th>
                    <th class="min-w-60">性別</th>
                    <th class="min-w-80">クラス</th>
                    <th class="min-w-120">実施課題</th>
                    <th class="min-w-100">学習状況</th>
                    <th class="min-w-100">学習意欲</th>
                    <th class="min-w-100">宿題提出</th>
                    <th class="min-w-100">ステータス</th>
                    <th class="min-w-80">データ数</th>
                    <th class="min-w-120">最終更新</th>
                    <th class="min-w-180">操作</th>
                </tr>
              </thead>
                <tbody id="progressTableBody">
                <!-- データは動的に生成 -->
              </tbody>
            </table>
            </div>
            <div class="alert alert-info" class="m-custom">
              <i class="fas fa-info-circle"></i>
              表が横に長い場合は、横スクロールで全ての項目を確認できます。氏名列は固定されています。
            </div>
          </div>
        </div>

        <!-- AI分析タブ -->
        <div id="analysis-tab" class="tab-content hidden">
          <h2 class="card-title">AI分析・児童観察記録</h2>
          
          <!-- AI分析実行オプション -->
          <div class="card">
            <div class="text-center-mb-2">
              <h2 class="heading-primary-hero">
                🚀 AI分析実行
                <button data-action="open-modal" data-target="analysisTipsModal" data-hover="scale" class="badge-interactive" title="分析実行のコツを表示">
                  i
                </button>
              </h2>
              <p class="text-secondary-lg-mt">
                児童の学習状況をAIが分析し、具体的な指導提案を提供します
              </p>
            </div>
            
            <div class="grid-auto-fit-350">
              <!-- クラス全体分析カード -->
              <div class="analysis-card--centered">
                <div class="badge-primary">1</div>
                <div class="flex-center-mb-1-centered">
                  <div>
                    <i class="fas fa-users" class="text-primary-lg" style="display: block; margin-bottom: 0.5rem;"></i>
                    <h4 class="text-primary-bold">クラス全体分析</h4>
                    <p class="text-secondary-sm">学級全体の傾向を把握</p>
                  </div>
                </div>
                <div class="mb-1">
                  <p class="text-primary-sm-lh-mb-half">
                    <strong>📊 分析内容:</strong> 全児童の学習状況・意欲などの分析<br>
                    <strong>🎯 活用場面:</strong> 保護者会、指導方針検討、学級の改善
                  </p>
                </div>
                <button class="btn btn-primary" data-action="run-analysis" data-type="class" class="btn-full-primary">
                  <i class="fas fa-chart-bar" class="mr-half"></i> クラス全体分析を実行
                </button>
              </div>
              
              <!-- 全員個別分析カード -->
              <div class="analysis-card--secondary-centered">
                <div class="badge-secondary">2</div>
                <div class="flex-center-mb-1-centered">
                  <div>
                    <i class="fas fa-user-friends" class="text-secondary-lg" style="display: block; margin-bottom: 0.5rem;"></i>
                    <h4 class="text-secondary-bold">全員個別分析</h4>
                    <p class="text-secondary-sm">全児童を一括で分析</p>
                  </div>
                </div>
                <div class="mb-1">
                  <p class="text-primary-sm-lh-mb-half">
                    <strong>📊 分析内容:</strong> 各児童の個別成長パターンと指導提案<br>
                    <strong>🎯 活用場面:</strong> 個人面談準備、通知表作成、個別指導
                  </p>
                </div>
                <button class="btn btn-secondary" data-action="run-analysis" data-type="all-individual" class="btn-full-secondary-complex">
                  <i class="fas fa-users-cog" class="mr-half"></i> 全員個別分析を実行
                </button>
              </div>
              
              <!-- 特定児童分析カード -->
              <div class="analysis-card--success-centered">
                <div class="badge-success">3</div>
                <div class="flex-center-mb-1-centered">
                  <div>
                    <i class="fas fa-user" class="text-success-lg" style="display: block; margin-bottom: 0.5rem;"></i>
                    <h4 class="text-success-bold">特定児童分析</h4>
                    <p class="text-secondary-sm">気になる児童を選択分析</p>
                  </div>
                </div>
                <div class="mb-1">
                  <p class="text-primary-sm-lh-mb-half">
                    <strong>📊 分析内容:</strong> 特定児童の詳細な学習状況と支援策<br>
                    <strong>🎯 活用場面:</strong> 個別相談、保護者面談、支援計画作成
                  </p>
                </div>
                <button class="btn btn-success" data-action="run-analysis" data-type="individual" class="btn-full-primary">
                  <i class="fas fa-search" class="mr-half"></i> 特定児童分析を実行
                </button>
              </div>
            </div>
            

          </div>
          
          <!-- AI分析結果テーブル -->
          <div class="card">
            <h3 class="card-title">🧠 AI分析結果</h3>
            <div id="analysisResultsTable">
              <div class="alert alert-info">
              <i class="fas fa-info-circle"></i>
                まだ分析結果がありません。上記のボタンからAI分析を実行してください。分析結果は以下のテーブルに表示されます。
                <br><br>
                <strong>期待される分析内容：</strong>
                <ul class="mt-half">
                  <li>「○○さんは最近理解度が落ちているので復習を増やしましょう」</li>
                  <li>「学習意欲が向上しており、発展的な内容に挑戦する時期です」</li>
                  <li>「宿題提出率が下がっているため、家庭との連携が必要です」</li>
                </ul>
              </div>
            </div>
          </div>
          
          <div class="card">
            <h3 class="card-title">📋 全体のAI分析履歴</h3>
            <div id="analysisHistoryPreview">
              <div class="alert alert-info">
                <i class="fas fa-info-circle"></i>
                まだ分析結果がありません。上記のボタンからAI分析を実行すると、結果がここに履歴として蓄積されます。
              </div>
            </div>
          </div>
          
          <!-- 親御さん向けレポート -->
          <div class="card">
            <div class="text-center-mb-2">
              <h2 class="color-secondary-center-large">
                <i class="fas fa-heart" class="color-secondary"></i>
                親御さん向けレポート
              </h2>
              <p class="text-secondary-md">
                保護者面談や家庭連携に活用できる、わかりやすいレポートを自動生成
              </p>
            </div>
            
            <!-- レポート生成ボタン -->
            <div class="text-center-mb-2">
              <div class="grid-auto-fit-300">
                <!-- クラス全体レポート -->
                <div class="card-secondary">
                  <div class="flex-center-mb-1-centered">
                    <div>
                      <i class="fas fa-users color-secondary-2xl-mr" style="display: block; margin-bottom: 0.5rem; margin-right: 0;"></i>
                      <h4 class="text-secondary-bold">クラス全体レポート</h4>
                      <p class="text-secondary-sm">学級の様子を保護者向けに</p>
                    </div>
                  </div>
                  <button class="btn btn-secondary w-full text-center" data-action="open-modal" data-target="classReportModal">
                    <i class="fas fa-file-alt mr-half"></i> クラス全体レポート作成
                  </button>
                </div>
                
                <!-- 個別児童レポート -->
                <div class="card-accent">
                  <div class="flex-center-mb-1-centered">
                    <div>
                      <i class="fas fa-child color-accent-2xl-mr" style="display: block; margin-bottom: 0.5rem; margin-right: 0;"></i>
                      <h4 class="text-accent-bold">個別児童レポート</h4>
                      <p class="text-secondary-sm">お子様の成長を詳しく</p>
                    </div>
                  </div>
                  <button class="btn btn-primary w-full text-center" data-action="generate-report" data-type="parent-individual">
                    <i class="fas fa-user-edit mr-half"></i> 個別レポート作成
                  </button>
                </div>
              </div>
            </div>
            
            <!-- 親御さん向けレポート履歴 -->
            <div>
              <h3 class="color-secondary-heading">
                <i class="fas fa-history"></i> 親御さん向けレポート履歴
              </h3>
              <div id="parentReportHistory">
                <div class="alert alert-info">
                  <i class="fas fa-info-circle"></i>
                  まだ親御さん向けレポートが作成されていません。上記のボタンからレポートを作成すると、ここに履歴が表示されます。
                  <br><br>
                  <strong>活用例：</strong>
                  <ul class="mt-half">
                    <li>保護者面談での資料として活用</li>
                    <li>家庭訪問時の話題提供</li>
                    <li>学級通信への内容反映</li>
                    <li>個別の成長記録として保管</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          

        </div>

        <!-- システム概要タブ -->
        <div id="system-overview-tab" class="tab-content hidden">
          <h2 class="card-title">システム概要</h2>
          
          <!-- 教育現場での活用方法 -->
          <div class="card">
            <h3 class="card-title">🎯 教育現場での活用方法</h3>
            <div class="mb-1">
              <h4 class="heading-primary-border">
                <i class="fas fa-graduation-cap"></i> 児童の変化を「言語化」する価値
              </h4>
            </div>
            
            <!-- 2x2グリッド表示 -->
            <div class="grid-2x2" class="grid-2x2-800">
              <!-- 左上: 保護者面談カード -->
              <div class="analysis-card--full">
                <div class="flex-center-mb-075">
                  <i class="fas fa-users" class="color-primary-lg-mr"></i>
                  <h5 class="text-primary-600">保護者面談</h5>
                </div>
                <p class="text-primary-sm-lh16">
                  「最近の学習状況について<br><strong>具体的なデータと分析</strong>があります」
                </p>
              </div>
              
              <!-- 右上: 指導計画見直しカード -->
              <div class="analysis-card--success-full">
                <div class="flex-center-mb-075">
                  <i class="fas fa-clipboard-list" class="color-success-lg-mr"></i>
                  <h5 class="text-success-600">指導計画見直し</h5>
                </div>
                <p class="text-primary-sm-lh16">
                  「AIが提案する<br><strong>個別指導ポイント</strong>を参考に」
                </p>
              </div>
              
              <!-- 左下: チーム会議カード -->
              <div class="analysis-card--warning-full">
                <div class="flex-center-mb-075">
                  <i class="fas fa-comments" class="color-warning-lg-mr"></i>
                  <h5 class="text-warning-600">チーム会議</h5>
                </div>
                <p class="text-primary-sm-lh16">
                  「<strong>客観的な分析結果</strong>を基に<br>指導方針を検討」
                </p>
              </div>
              
              <!-- 右下: 成長記録カード -->
              <div class="analysis-card--secondary-full">
                <div class="flex-center-mb-075">
                  <i class="fas fa-chart-line" class="color-secondary-lg-mr"></i>
                  <h5 class="text-secondary-600">成長記録</h5>
                </div>
                <p class="text-primary-sm-lh16">
                  「<strong>小さな変化の積み重ね</strong>を<br>可視化」
                </p>
              </div>
            </div>
            
            <!-- 親御さん向けレポートの特徴説明 -->
            <div class="card-info">
              <h5 class="heading-primary-flex">
                <i class="fas fa-heart" class="mr-half"></i>
                親御さん向けレポートの特徴
              </h5>
              <div class="grid-auto-fit-180">
                <div class="bg-card-white">
                  <div class="flex-center-mb-half">
                    <i class="fas fa-comment" class="color-primary-mr"></i>
                    <strong class="text-primary-sm-simple">わかりやすい表現</strong>
                  </div>
                  <p class="text-secondary-xs">専門用語を避けた親しみやすい文章</p>
                </div>
                
                <div class="white-card-success">
                  <div class="flex-center-mb-half">
                    <i class="fas fa-lightbulb" class="color-success-mr"></i>
                    <strong class="color-success-sm">具体的なアドバイス</strong>
                  </div>
                  <p class="text-secondary-xs">家庭でできる支援方法を提案</p>
                </div>
                
                <div class="white-card-warning">
                  <div class="flex-center-mb-half">
                    <i class="fas fa-chart-line" class="color-warning-mr"></i>
                    <strong class="text-warning-sm">成長の可視化</strong>
                  </div>
                  <p class="text-secondary-xs">お子様の良い点を積極的に紹介</p>
                </div>
                
                <div class="white-card-secondary">
                  <div class="flex-center-mb-half">
                    <i class="fas fa-handshake" class="text-secondary-mr"></i>
                    <strong class="color-secondary-sm">連携のポイント</strong>
                  </div>
                  <p class="text-secondary-xs">学校と家庭の協力方法を明示</p>
                </div>
              </div>
            </div>
            
            <div class="info-box-accent">
              <p class="text-primary-center">
                <i class="fas fa-lightbulb" class="mr-half"></i>
                データを活用した<strong>エビデンス・ベースド教育</strong>の実現
              </p>
            </div>
            
            <!-- レスポンシブ対応用のモバイル表示 -->
            <style>
              @media (max-width: 768px) {
                .grid-2x2 {
                  grid-template-columns: 1fr !important;
                  grid-template-rows: auto !important;
                }
              }
            </style>
          </div>
          
          <!-- AI分析システム設定 -->
          <div class="card">
            <div class="text-center-mb-2">
              <h2 class="heading-primary-center">
                <i class="fas fa-brain" class="color-primary"></i>
                AI分析システム設定
              </h2>
              <p class="text-secondary-md">
                教育現場に特化したAI分析エンジンの詳細情報
              </p>
            </div>
            
            <div class="grid-auto-fit-320">
              <!-- AI技術情報カード -->
              <div class="analysis-card">
                <div class="flex-center-mb-1">
                  <i class="fas fa-microchip" class="text-primary-lg"></i>
                  <div>
                    <h4 class="text-primary-bold">AI技術仕様</h4>
                    <p class="text-secondary-sm">使用されているAI技術</p>
                  </div>
                </div>
                <div class="space-y-075">
                  <div class="mb-075">
                    <strong class="text-primary-sm-simple">🤖 AIモデル:</strong>
                    <p class="text-primary-sm-lh">
                      meta-llama/Llama-4-Maverick-17B-128E-Instruct
                    </p>
                  </div>
                  <div class="mb-075">
                    <strong class="text-primary-sm-simple">⚙️ 処理方式:</strong>
                    <p class="text-primary-sm-lh">
                      大規模言語モデル（LLM）による自然言語処理
                    </p>
                  </div>
                  <div>
                    <strong class="text-primary-sm-simple">🎯 特化領域:</strong>
                    <p class="text-primary-sm-lh">
                      教育データ解析・指導提案生成
                    </p>
                  </div>
                </div>
              </div>
              
              <!-- 分析機能カード -->
              <div class="analysis-card--success">
                <div class="flex-center-mb-1">
                  <i class="fas fa-chart-line" class="text-success-lg"></i>
                  <div>
                    <h4 class="text-success-bold">分析機能</h4>
                    <p class="text-secondary-sm">AI分析の対応範囲</p>
                  </div>
                </div>
                <div class="space-y-half">
                  <div class="flex-center-mb-half">
                    <i class="fas fa-users" class="icon-success"></i>
                    <span class="text-primary-sm">クラス全体の傾向分析</span>
                  </div>
                  <div class="flex-center-mb-half">
                    <i class="fas fa-user" class="icon-success"></i>
                    <span class="text-primary-sm">個別児童の成長パターン分析</span>
                  </div>
                  <div class="flex-center-mb-half">
                    <i class="fas fa-lightbulb" class="icon-success"></i>
                    <span class="text-primary-sm">具体的指導提案の生成</span>
                  </div>
                  <div class="flex-center-mb-half">
                    <i class="fas fa-exclamation-triangle" class="icon-success"></i>
                    <span class="text-primary-sm">注意が必要な変化の検出</span>
                  </div>
                  <div class="flex-center">
                    <i class="fas fa-home" class="icon-success"></i>
                    <span class="text-primary-sm">保護者連携アドバイス</span>
                  </div>
                </div>
              </div>
              
              <!-- 出力形式カード -->
              <div class="analysis-card--warning">
                <div class="flex-center-mb-1">
                  <i class="fas fa-file-alt" class="color-warning-2xl-mr"></i>
                  <div>
                    <h4 class="text-warning-bold">出力形式</h4>
                    <p class="text-secondary-sm">分析結果の表示方法</p>
                  </div>
                </div>
                <div class="space-y-075">
                  <div class="mb-075">
                    <strong class="text-warning-sm">📝 構造化レポート:</strong>
                    <p class="text-primary-sm-lh">
                      セクション別に整理された読みやすい形式
                    </p>
                  </div>
                  <div class="mb-075">
                    <strong class="text-warning-sm">🎨 視覚的ハイライト:</strong>
                    <p class="text-primary-sm-lh">
                      重要ポイント・注意点・アクションプランを色分け表示
                    </p>
                  </div>
                  <div>
                    <strong class="text-warning-sm">📊 定量的データ:</strong>
                    <p class="text-primary-sm-lh">
                      数値に基づく客観的な分析結果
                    </p>
                  </div>
                </div>
              </div>
              
              <!-- データ活用カード -->
              <div class="analysis-card--secondary">
                <div class="flex-center-mb-1">
                  <i class="fas fa-database" class="text-secondary-lg"></i>
                  <div>
                    <h4 class="text-secondary-bold">データ活用</h4>
                    <p class="text-secondary-sm">分析に使用されるデータ</p>
                  </div>
                </div>
                <div class="space-y-half">
                  <div class="flex-center-mb-half">
                    <i class="fas fa-star" class="icon-secondary"></i>
                    <span class="text-primary-sm">学習状況（5段階評価）</span>
                  </div>
                  <div class="flex-center-mb-half">
                    <i class="fas fa-heart" class="icon-secondary"></i>
                    <span class="text-primary-sm">学習意欲（5段階評価）</span>
                  </div>
                  <div class="flex-center-mb-half">
                    <i class="fas fa-clipboard-check" class="icon-secondary"></i>
                    <span class="text-primary-sm">宿題提出状況</span>
                  </div>
                  <div class="flex-center-mb-half">
                    <i class="fas fa-sticky-note" class="icon-secondary"></i>
                    <span class="text-primary-sm">観察記録・備考</span>
                  </div>
                  <div class="flex-center">
                    <i class="fas fa-clock" class="icon-secondary"></i>
                    <span class="text-primary-sm">時系列変化パターン</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- AIの特長説明 -->
            <div class="info-box-primary">
              <div class="text-center-mb-2">
                <h4 class="heading-primary-lg">
                  <i class="fas fa-magic" class="mr-half"></i>
                  このAI分析システムの特長
                </h4>
              </div>
              
              <!-- 2x2グリッドレイアウト -->
              <div class="grid-2x2-1000">
                
                <!-- 左上: 教育現場専用 -->
                <div class="analysis-card--tall">
                  <div class="flex-center-mb-1">
                    <i class="fas fa-graduation-cap" class="color-primary-1xl-mr"></i>
                    <h5 class="text-primary-bold">教育現場専用</h5>
                  </div>
                  <div class="flex-1-col-center">
                    <p class="text-primary-sm-lh16-mb">
                      <strong>小学校教育に特化した分析ロジック</strong>
                    </p>
                    <p class="text-secondary-sm-lh">
                      児童の発達段階を考慮し、学年に応じた適切な評価基準で分析を実行。教育現場の実情に合わせた実用的な提案を生成します。
                    </p>
                  </div>
                </div>
                
                <!-- 右上: 変化の可視化 -->
                <div class="analysis-card--success-tall">
                  <div class="flex-center-mb-1">
                    <i class="fas fa-eye" class="color-success-2xl-mr"></i>
                    <h5 class="text-success-bold">変化の可視化</h5>
                  </div>
                  <div class="flex-1-col-center">
                    <p class="text-primary-sm-lh16-mb">
                      <strong>小さな成長や変化も見逃さない</strong>
                    </p>
                    <p class="text-secondary-sm-lh">
                      時系列データから微細な変化パターンを検出し、気づきにくい成長の兆しや注意すべき変化を早期に発見します。
                    </p>
                  </div>
                </div>
                
                <!-- 左下: 実践的提案 -->
                <div class="analysis-card--warning-tall">
                  <div class="flex-center-mb-1">
                    <i class="fas fa-tools" class="color-warning-1xl-mr"></i>
                    <h5 class="text-warning-bold">実践的提案</h5>
                  </div>
                  <div class="flex-1-col-center">
                    <p class="text-primary-sm-lh16-mb">
                      <strong>明日から使える具体的な指導案</strong>
                    </p>
                    <p class="text-secondary-sm-lh">
                      抽象的なアドバイスではなく、授業や個別指導ですぐに活用できる具体的な手法やアプローチを提案します。
                    </p>
                  </div>
                </div>
                
                <!-- 右下: 家庭連携 -->
                <div class="analysis-card--secondary-tall">
                  <div class="flex-center-mb-1">
                    <i class="fas fa-handshake" class="color-secondary-2xl-mr"></i>
                    <h5 class="text-secondary-bold">家庭連携</h5>
                  </div>
                  <div class="flex-1-col-center">
                    <p class="text-primary-sm-lh16-mb">
                      <strong>保護者との協力ポイントも提案</strong>
                    </p>
                    <p class="text-secondary-sm-lh">
                      学校での取り組みと連動した家庭でのサポート方法を提案し、学校と家庭が一体となった支援体制を構築します。
                    </p>
                  </div>
                </div>
              </div>
              
              <!-- レスポンシブ対応のスタイル -->
              <style>
                @media (max-width: 768px) {
                  .grid-2x2-features {
                    grid-template-columns: 1fr !important;
                    grid-template-rows: auto !important;
                  }
                }
              </style>
              <script>
                // レスポンシブ対応のためのクラス追加
                document.addEventListener('DOMContentLoaded', function() {
                  const grid = document.querySelector('[style*="grid-template-columns: 1fr 1fr"]');
                  if (grid) {
                    grid.classList.add('grid-2x2-features');
                  }
                });
              </script>
            </div>
          </div>
        </div>

        <!-- 設定タブ -->
        <div id="settings-tab" class="tab-content hidden">
          <h2 class="card-title">設定</h2>
          
          <!-- 項目設定 -->
          <div class="card">
            <h3 class="card-title">入力項目設定</h3>
            
            <!-- 組み込み項目選択セクション -->
            <div class="mb-2">
              <div class="flex-center-gap-1">
                <h4 class="text-primary-lg-600">
                  <i class="fas fa-star"></i> 組み込み項目から選択
                </h4>
                <span class="highlight-sm">
                  よく使われる項目
                </span>
              </div>
              <p class="text-secondary-mb-lg">
                教育現場でよく使われる項目を簡単に追加できます。カテゴリから選択して「追加」ボタンをクリックしてください。
              </p>
              
              <div id="builtInFieldsContainer">
                <!-- 動的に生成される組み込み項目 -->
              </div>
            </div>
            
            <!-- 既存項目表示 -->
            <div class="border-top-spacer">
              <h4 class="text-primary-lg-mb">
                <i class="fas fa-list"></i> 現在の設定項目
              </h4>
              <div id="fieldSettings">
                <!-- 動的に生成 -->
              </div>
              <button class="btn btn-primary" data-action="open-modal" data-target="addFieldModal" class="mt-1">
                <i class="fas fa-plus"></i> カスタム項目を追加
              </button>
            </div>
          </div>
          
          <!-- 児童管理 -->
          <div class="card">
            <h3 class="card-title">児童管理</h3>
            <div id="studentManagementSettings">
              <!-- 動的に生成される児童削除リスト -->
            </div>
            <div class="card-error">
              <div class="flex-gap-1-mb-075">
                <div class="badge-circle badge-circle--error">
                  <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h4 class="text-red-bold">重要な注意事項</h4>
              </div>
              <p class="text-dark-red">
                <i class="fas fa-trash-alt" class="icon-danger"></i>
                児童を削除すると、その児童のすべての進捗記録も削除されます。
                <br>
                <strong class="color-danger">この操作は取り消すことができません。</strong>
              </p>
              <div class="warning-box-primary">
                <small class="color-danger-bold">
                  <i class="fas fa-lightbulb" class="icon-warning"></i>
                  重要なデータは事前にエクスポート機能でバックアップを取ることをお勧めします。
                </small>
              </div>
            </div>
          </div>
          
          <!-- レポート生成設定 -->
          <div class="card">
            <h3 class="card-title">
              <i class="fas fa-file-alt"></i> レポート生成設定
            </h3>
            
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-history"></i> 使用するデータの範囲
              </label>
              <p class="text-secondary mb-2">
                親御さん向けレポートや AI分析で使用する過去のデータ数を指定できます
              </p>
              
              <div class="grid-2-cols gap-4">
                <div class="form-group">
                  <label class="form-label-sm">個別レポート用データ数</label>
                  <select id="individualReportDataCount" class="form-select">
                    <option value="1">最新1回分のみ</option>
                    <option value="2">最新2回分</option>
                    <option value="3" selected>最新3回分</option>
                    <option value="5">最新5回分</option>
                    <option value="7">最新7回分</option>
                    <option value="10">最新10回分</option>
                    <option value="all">すべてのデータ</option>
                  </select>
                  <small class="form-help">
                    個別児童の親御さん向けレポート作成時に使用
                  </small>
                </div>
                
                <div class="form-group">
                  <label class="form-label-sm">AI分析用データ数</label>
                  <select id="analysisDataCount" class="form-select">
                    <option value="3">最新3回分</option>
                    <option value="5" selected>最新5回分</option>
                    <option value="7">最新7回分</option>
                    <option value="10">最新10回分</option>
                    <option value="15">最新15回分</option>
                    <option value="all">すべてのデータ</option>
                  </select>
                  <small class="form-help">
                    AI分析（個別・クラス全体）で使用
                  </small>
                </div>
              </div>
              
              <div class="form-group mt-3">
                <label class="form-label-sm">レポートの詳細度</label>
                <select id="reportDetailLevel" class="form-select">
                  <option value="simple">簡易レポート - コンパクトで要点を絞った内容</option>
                  <option value="detailed" selected>詳細レポート - 包括的で詳しい分析内容</option>
                </select>
                <small class="form-help">
                  親御さん向けレポートとAI分析の詳細度を設定します
                </small>
              </div>
              
              <div class="form-group mt-3">
                <label class="form-label-sm">PDFレポート作成者名</label>
                <input type="text" id="pdfCreatorName" class="form-input" placeholder="児童進捗管理ツール" maxlength="50">
                <small class="form-help">
                  PDF出力時にレポート下部に表示される作成者名を設定できます
                </small>
              </div>
              
              <div class="bg-info mt-3">
                <h4 class="text-primary">
                  <i class="fas fa-lightbulb"></i> レポート設定について
                </h4>
                <div class="grid-2-cols gap-4 text-sm mt-2">
                  <div>
                    <h5 class="text-primary-lg mb-1">データ数の選択</h5>
                    <ul>
                      <li><strong>少ないデータ数（1-3回）:</strong> 最新の状況に特化した分析</li>
                      <li><strong>中程度のデータ数（5-7回）:</strong> 最近の傾向を把握（推奨）</li>
                      <li><strong>多いデータ数（10回以上）:</strong> 長期的な成長パターンの分析</li>
                      <li><strong>すべてのデータ:</strong> 最も包括的な分析</li>
                    </ul>
                  </div>
                  <div>
                    <h5 class="text-primary-lg mb-1">レポートの詳細度</h5>
                    <ul>
                      <li><strong>簡易レポート:</strong> 要点を絞ったコンパクトな内容（読みやすさ重視）</li>
                      <li><strong>詳細レポート:</strong> 包括的で詳しい分析内容（情報量重視）</li>
                    </ul>
                    <p class="mt-2"><i class="fas fa-info-circle text-primary"></i> 簡易レポートは処理時間も短縮されます</p>
                  </div>
                </div>
              </div>
              
              <button class="btn btn-primary mt-3" onclick="saveReportSettings()">
                <i class="fas fa-save"></i> 設定を保存
              </button>
            </div>
          </div>

          <!-- データ管理 -->
          <div class="card">
            <h3 class="card-title">データ管理</h3>
            
            <!-- データバックアップ・復旧 -->
            <div class="mb-3">
              <h4 class="text-primary-lg mb-2">
                <i class="fas fa-shield-alt"></i> データ保護・バックアップ
              </h4>
              <div class="bg-info mb-2">
                <p class="text-sm">
                  <i class="fas fa-info-circle"></i>
                  AI分析結果は自動的に複数箇所にバックアップされ、5分ごとに自動保存されています。
                  手動でバックアップファイルを作成することもできます。
                </p>
              </div>
              <div class="flex gap-2 flex-wrap">
                <button class="btn btn-primary" onclick="createManualBackup()">
                  <i class="fas fa-download"></i> 手動バックアップ作成
                </button>
                <button class="btn btn-info" onclick="showBackupStatus()">
                  <i class="fas fa-info-circle"></i> バックアップ状況確認
                </button>
              </div>
            </div>
            
            <!-- 通常のデータ管理 -->
            <div class="border-top-spacer">
              <h4 class="text-primary-lg mb-2">
                <i class="fas fa-database"></i> データ操作
              </h4>
              <div class="flex gap-2 flex-wrap">
                <button class="btn btn-success" data-action="export-data">
                  <i class="fas fa-download"></i> データエクスポート
                </button>
                <button class="btn btn-warning" data-action="import-data">
                  <i class="fas fa-upload"></i> データインポート
                </button>
                <button class="btn btn-secondary" data-action="view-analysis-history">
                  <i class="fas fa-history"></i> 全体のAI分析履歴
                </button>
                <button class="btn btn-warning" data-action="clear-analysis-history">
                  <i class="fas fa-trash"></i> AI分析履歴クリア
                </button>
                <button class="btn btn-error" data-action="confirm-clear-all-data">
                  <i class="fas fa-trash"></i> 全データ削除
                </button>
                <button class="btn btn-primary" data-action="ensure-data-compatibility">
                  <i class="fas fa-tags"></i> 行動タグ機能を追加
                </button>
              </div>
            </div>
          </div>



        </div>
      </main>
    </div>
  </div>

  <!-- 個別AI分析モーダル -->
  <div id="individualAnalysisModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">個別AI分析実行</h3>
        <button class="modal-close" data-action="close-modal" data-target="individualAnalysisModal">&times;</button>
      </div>
            <div class="form-group">
        <label class="form-label">分析対象の児童を選択してください</label>
        <select id="individualAnalysisStudentSelect" class="form-select" required>
          <option value="">児童を選択してください</option>
        </select>
            </div>
      <div class="flex gap-2">
        <button class="btn btn-primary" data-action="run-analysis" data-type="execute-individual">
          <i class="fas fa-brain"></i> 分析実行
        </button>
        <button class="btn btn-secondary" data-action="close-modal" data-target="individualAnalysisModal">
          キャンセル
            </button>
          </div>
        </div>
  </div>

  <!-- 親御さん向け個別レポート選択モーダル -->
  <div id="parentReportStudentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">
          <i class="fas fa-heart" class="text-secondary-mr"></i>
          親御さん向け個別レポート作成
        </h3>
        <button class="modal-close" data-action="close-modal" data-target="parentReportStudentModal">&times;</button>
      </div>
      <div class="form-group">
        <label class="form-label">レポートを作成する児童を選択してください</label>
        <select id="parentReportStudentSelect" class="form-select" required>
          <option value="">児童を選択してください</option>
        </select>
      </div>
      <div class="bg-card-secondary">
        <h4 class="text-secondary-md-mb">
          <i class="fas fa-info-circle"></i> 親御さん向けレポートについて
        </h4>
        <ul class="text-primary-sm-lh16-simple">
          <li>お子様の成長や頑張りを<strong>温かい表現</strong>でお伝えします</li>
          <li>家庭でできる<strong>具体的なサポート方法</strong>を提案します</li>
          <li>専門用語を使わず、<strong>わかりやすい言葉</strong>で説明します</li>
          <li>お子様の<strong>良い点や可能性</strong>を積極的に紹介します</li>
        </ul>
      </div>
      <div class="flex gap-2">
        <button class="btn" data-action="generate-report" data-type="parent-execute" class="btn-secondary">
          <i class="fas fa-heart"></i> レポート作成
        </button>
        <button class="btn btn-secondary" data-action="close-modal" data-target="parentReportStudentModal">
          キャンセル
        </button>
      </div>
    </div>
  </div>

  <!-- クラス全体レポート選択モーダル -->
  <div id="classReportModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">
          <i class="fas fa-users" class="text-secondary-mr"></i>
          クラス全体レポート作成
        </h3>
        <button class="modal-close" data-action="close-modal" data-target="classReportModal">&times;</button>
      </div>
      <div class="flex-gap-1-mb-1-5-purple">
        <i class="fas fa-graduation-cap" class="color-secondary-lg"></i>
        <div>
          <h4 class="text-secondary-600">対象クラスを選択</h4>
          <p class="text-secondary-sm">レポートを作成する学年・クラスを指定してください</p>
        </div>
      </div>
      
      <div class="grid-2-cols">
        <div class="form-group">
          <label class="form-label">学年 *</label>
          <select id="classReportGrade" class="form-select" onchange="updateClassReportClassOptions()">
            <option value="">学年を選択</option>
            <option value="all">全学年</option>
            <option value="1">1年生</option>
            <option value="2">2年生</option>
            <option value="3">3年生</option>
            <option value="4">4年生</option>
            <option value="5">5年生</option>
            <option value="6">6年生</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">クラス *</label>
          <select id="classReportClass" class="form-select" onchange="updateClassReportPreview()">
            <option value="">クラスを選択</option>
            <option value="all">全クラス</option>
          </select>
        </div>
      </div>
      
      <div id="classReportPreview" class="hidden-box">
        <div class="flex-center-gap mb-half">
          <i class="fas fa-info-circle" class="text-accent"></i>
          <strong class="text-accent">対象児童</strong>
        </div>
        <div id="classReportStudentList" class="text-primary-sm">
        </div>
      </div>
      
      <div class="flex gap-2" class="mt-1-5">
        <button class="btn" data-action="generate-report" data-type="class-execute" id="classReportGenerateBtn" class="btn-secondary" disabled>
          <i class="fas fa-users"></i> レポート作成
        </button>
        <button class="btn btn-secondary" data-action="close-modal" data-target="classReportModal">
          キャンセル
        </button>
      </div>
    </div>
  </div>

  <!-- AI分析履歴モーダル -->
  <div id="analysisHistoryModal" class="modal">
    <div class="modal-content" class="max-w-1000">
      <div class="modal-header">
        <h3 class="modal-title">AI分析履歴</h3>
        <button class="modal-close" data-action="close-modal" data-target="analysisHistoryModal">&times;</button>
      </div>
      <div id="analysisHistoryContent">
        <!-- 動的に生成される分析履歴 -->
      </div>
    </div>
  </div>

  <!-- 分析パターン説明モーダル -->
  <div id="analysisPatternModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">🎯 分析パターン説明</h3>
        <button class="modal-close" data-action="close-modal" data-target="analysisPatternModal">&times;</button>
      </div>
      <div class="alert alert-info" class="m-0-simple">
        <ul class="m-0-simple">
          <li><strong>児童全体分析:</strong> クラス全体の傾向と指導方針を分析</li>
          <li><strong>児童全員の個別分析:</strong> 全児童の個別分析を一括実行</li>
          <li><strong>児童個別分析:</strong> 特定の児童を選択して分析</li>
        </ul>
      </div>
      <div class="mt-1">
        <button class="btn btn-secondary" data-action="close-modal" data-target="analysisPatternModal">
          閉じる
        </button>
      </div>
    </div>
  </div>

  <!-- 児童進捗履歴モーダル -->
  <div id="studentProgressModal" class="modal">
    <div class="modal-content" class="max-w-900">
      <div class="modal-header">
        <h3 class="modal-title" id="progressModalTitle">児童進捗履歴</h3>
        <button class="modal-close" data-action="close-modal" data-target="studentProgressModal">&times;</button>
      </div>
      <div id="progressModalContent">
        <!-- 動的に生成される進捗履歴 -->
      </div>
    </div>
  </div>

  <!-- 児童編集モーダル -->
  <div id="editStudentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">児童情報編集</h3>
        <button class="modal-close" data-action="close-modal" data-target="editStudentModal">&times;</button>
      </div>
      <form id="editStudentForm">
        <div class="form-group">
          <label class="form-label">氏名 *</label>
          <input type="text" id="editStudentName" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">在籍番号 *</label>
          <input type="text" id="editStudentNumber" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">学年 *</label>
          <select id="editStudentGrade" class="form-select" required>
            <option value="">選択してください</option>
            <option value="1">1年生</option>
            <option value="2">2年生</option>
            <option value="3">3年生</option>
            <option value="4">4年生</option>
            <option value="5">5年生</option>
            <option value="6">6年生</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">性別 *</label>
          <select id="editStudentGender" class="form-select" required>
            <option value="">選択してください</option>
            <option value="male">男子</option>
            <option value="female">女子</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">クラス</label>
          <input type="text" id="editStudentClass" class="form-input" placeholder="例: A組">
        </div>
        <div class="flex gap-2">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save"></i> 更新
          </button>
          <button type="button" class="btn btn-secondary" data-action="close-modal" data-target="editStudentModal">
            キャンセル
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- 児童追加モーダル -->
  <div id="addStudentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">児童情報追加</h3>
        <button class="modal-close" data-action="close-modal" data-target="addStudentModal">&times;</button>
      </div>
      <form id="addStudentForm">
        <div class="form-group">
          <label class="form-label">氏名 *</label>
          <input type="text" id="studentName" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">在籍番号 *</label>
          <input type="text" id="studentNumber" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">学年 *</label>
          <select id="studentGrade" class="form-select" required>
            <option value="">選択してください</option>
            <option value="1">1年生</option>
            <option value="2">2年生</option>
            <option value="3">3年生</option>
            <option value="4">4年生</option>
            <option value="5">5年生</option>
            <option value="6">6年生</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">性別 *</label>
          <select id="studentGender" class="form-select" required>
            <option value="">選択してください</option>
            <option value="male">男子</option>
            <option value="female">女子</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">クラス</label>
          <input type="text" id="studentClass" class="form-input" placeholder="例: A組">
        </div>
        <div class="flex gap-2">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-plus"></i> 追加
          </button>
          <button type="button" class="btn btn-secondary" data-action="close-modal" data-target="addStudentModal">
            キャンセル
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- 項目追加モーダル -->
  <div id="addFieldModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">入力項目追加</h3>
        <button class="modal-close" data-action="close-modal" data-target="addFieldModal">&times;</button>
      </div>
      <form id="addFieldForm">
        <div class="form-group">
          <label class="form-label">項目名 *</label>
          <input type="text" id="fieldName" class="form-input" required>
        </div>
        <div class="form-group">
          <label class="form-label">入力タイプ *</label>
          <select id="fieldType" class="form-select" required>
            <option value="">選択してください</option>
            <option value="select">選択式（5段階評価）</option>
            <option value="text">自由記述</option>
            <option value="number">数値入力</option>
            <option value="checkbox">チェックボックス</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">必須項目</label>
          <input type="checkbox" id="fieldRequired"> 必須入力にする
        </div>
        <div class="flex gap-2">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-plus"></i> 追加
          </button>
          <button type="button" class="btn btn-secondary" data-action="close-modal" data-target="addFieldModal">
            キャンセル
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- 分析実行のコツモーダル -->
  <div id="analysisTipsModal" class="modal">
    <div class="modal-content" class="max-w-600">
      <div class="modal-header">
        <h3 class="modal-title" class="color-primary-flex-gap">
          <i class="fas fa-lightbulb"></i>
          分析実行のコツ
        </h3>
        <button class="modal-close" data-action="close-modal" data-target="analysisTipsModal">&times;</button>
      </div>
      <div class="p-0">
        <div class="bg-card-primary">
          <p class="text-primary-md-mb">
            効果的なAI分析を行うための段階的なアプローチをご紹介します。
          </p>
          <div class="grid-gap">
            <div class="bg-card-white">
              <div class="flex-center-mb-half">
                <span class="badge-circle badge-circle--primary">1</span>
                <strong class="color-primary-base">初回: クラス全体分析から開始</strong>
              </div>
              <p class="text-primary-sm-lh-pl">
                まずは学級全体の傾向を把握し、指導の方向性を決めましょう
              </p>
            </div>
            
            <div class="bg-card-white">
              <div class="flex-center-mb-half">
                <span class="badge-circle badge-circle--success">2</span>
                <strong class="color-success-base">定期: 全員個別分析で成長追跡</strong>
              </div>
              <p class="text-primary-sm-lh-pl">
                定期的に全児童の個別分析を行い、成長の変化を継続的に追跡します
              </p>
            </div>
            
            <div class="bg-card-white">
              <div class="flex-center-mb-half">
                <span class="badge-circle badge-circle--warning">3</span>
                <strong class="color-warning-base">課題: 特定児童分析で深掘り</strong>
              </div>
              <p class="text-primary-sm-lh-pl">
                気になる変化がある児童について、詳細な個別分析で課題を深掘りします
              </p>
            </div>
            
            <div class="bg-card-white">
              <div class="flex-center-mb-half">
                <span class="badge-circle badge-circle--secondary">4</span>
                <strong class="color-secondary-base">面談前: 個別分析で準備万全</strong>
              </div>
              <p class="text-primary-sm-lh-pl">
                保護者面談や個別相談の前に分析を実行し、具体的なデータで説明準備を整えます
              </p>
            </div>
          </div>
        </div>
        
        <div class="bg-card-accent">
          <div class="flex-center-mb-half">
            <i class="fas fa-star" class="color-accent-mr"></i>
            <strong class="text-accent">効果的な活用のポイント</strong>
          </div>
          <ul class="text-primary-sm-lh16-pl">
            <li>分析結果は<strong>指導の参考材料</strong>として活用する</li>
            <li>継続的にデータを蓄積することで<strong>変化の傾向</strong>が見えてくる</li>
            <li>保護者や同僚との<strong>情報共有</strong>に具体的なデータを活用する</li>
          </ul>
        </div>
      </div>
      <div class="mt-1-5-text-center">
        <button class="btn btn-primary" data-action="close-modal" data-target="analysisTipsModal">
          <i class="fas fa-check"></i> 理解しました
        </button>
      </div>
    </div>
  </div>

  <!-- ローディング表示 -->
  <div id="loading" class="loading">
    <div class="spinner"></div>
    <p>処理中...</p>
  </div>

  <!-- アラート表示エリア -->
  <div id="alertContainer" class="fixed-top-right">
  </div>

  <!-- PDF生成ライブラリ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="js/pdf-export.js"></script>
  <script>
    // jsPDFライブラリの読み込み確認
    window.addEventListener('load', function() {
      console.log('jsPDF library check:');
      console.log('window.jspdf:', typeof window.jspdf);
      console.log('window.jsPDF:', typeof window.jsPDF);
      console.log('global jsPDF:', typeof jsPDF);
      
      if (window.jspdf && window.jspdf.jsPDF) {
        console.log('jsPDF loaded successfully via window.jspdf.jsPDF');
      } else if (window.jsPDF) {
        console.log('jsPDF loaded successfully via window.jsPDF');
      } else {
        console.warn('jsPDF library may not be loaded correctly');
      }
    });
  </script>
  
  <script src="app.js"></script>
</body>
</html> 