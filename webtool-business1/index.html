<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ“ã‚¸ãƒã‚¹èµ·æ¥­ä½“é¨“ï¼†æ„æ€æ±ºå®šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Yu Gothic', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .progress-bar {
            background: rgba(255,255,255,0.3);
            height: 8px;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: white;
            height: 100%;
            width: 0%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .content {
            padding: 40px;
        }

        .stage-container {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .stage-container.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .stage-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .choices {
            display: grid;
            gap: 15px;
            margin: 30px 0;
        }

        .choice-button {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .choice-button:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.3);
        }

        .choice-button h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .choice-button p {
            font-size: 14px;
            opacity: 0.8;
        }

        .visual-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .visual-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .visual-box h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .visual-canvas {
            width: 100%;
            height: 150px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .feedback-box {
            background: #f0f7ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .feedback-box h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .feedback-box ul {
            list-style: none;
            padding-left: 0;
        }

        .feedback-box li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .feedback-box li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #667eea;
        }

        .danger-feedback {
            background: #fff5f5;
            border-left-color: #e74c3c;
        }

        .danger-feedback h4 {
            color: #e74c3c;
        }

        .danger-feedback li:before {
            content: "âš ";
            color: #e74c3c;
        }

        .summary-container {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .summary-container.active {
            display: block;
        }

        .company-summary {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }

        .btn-primary {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn-primary:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.3);
        }

        .decision-history {
            text-align: left;
            margin: 20px 0;
        }

        .decision-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 24px;
            }
            
            .content {
                padding: 20px;
            }
            
            .visual-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ãƒ“ã‚¸ãƒã‚¹èµ·æ¥­ä½“é¨“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h1>
            <p>ã‚ãªãŸã®é¸æŠã§ä¼šç¤¾ã®æœªæ¥ãŒæ±ºã¾ã‚‹</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </div>

        <div class="content">
            <!-- Stage 1: èµ·æ¥­ã‚¢ã‚¤ãƒ‡ã‚¢é¸å®š -->
            <div class="stage-container active" id="stage1">
                <h2 class="stage-title">ã‚¹ãƒ†ãƒ¼ã‚¸1: èµ·æ¥­ã‚¢ã‚¤ãƒ‡ã‚¢é¸å®š</h2>
                <p>ã©ã®åˆ†é‡ã§èµ·æ¥­ã—ã¾ã™ã‹ï¼Ÿã‚ãªãŸã®æƒ…ç†±ã¨å¸‚å ´ã®ãƒ‹ãƒ¼ã‚ºã‚’è€ƒãˆã¦é¸ã³ã¾ã—ã‚‡ã†ã€‚</p>
                
                <div class="choices">
                    <div class="choice-button" onclick="makeChoice(1, 'tech')">
                        <h3>ğŸš€ ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãƒ»AI</h3>
                        <p>æœ€å…ˆç«¯æŠ€è¡“ã§ç¤¾ä¼šèª²é¡Œã‚’è§£æ±ºã€‚é«˜æˆé•·ãŒæœŸå¾…ã§ãã‚‹ãŒç«¶äº‰ã‚‚æ¿€ã—ã„ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(1, 'health')">
                        <h3>ğŸ¥ ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢ãƒ»åŒ»ç™‚</h3>
                        <p>å¥åº·ã¨åŒ»ç™‚ã®é©æ–°ã€‚ç¤¾ä¼šè²¢çŒ®åº¦ãŒé«˜ãã€è¦åˆ¶å¯¾å¿œãŒå¿…è¦ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(1, 'eco')">
                        <h3>ğŸŒ± ç’°å¢ƒãƒ»ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£</h3>
                        <p>æŒç¶šå¯èƒ½ãªæœªæ¥ã‚’å‰µé€ ã€‚ESGæŠ•è³‡ã®æ³¨ç›®åº¦ãŒé«˜ã„ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(1, 'edu')">
                        <h3>ğŸ“š æ•™è‚²ãƒ»äººæé–‹ç™º</h3>
                        <p>å­¦ã³ã®é©æ–°ã§äººã€…ã®å¯èƒ½æ€§ã‚’æ‹¡ã’ã‚‹ã€‚å®‰å®šæˆé•·ãŒè¦‹è¾¼ã‚ã‚‹ã€‚</p>
                    </div>
                </div>

                <div class="visual-container" id="stage1-visuals"></div>
                <div id="stage1-feedback"></div>
            </div>

            <!-- Stage 2: è³‡é‡‘èª¿é” -->
            <div class="stage-container" id="stage2">
                <h2 class="stage-title">ã‚¹ãƒ†ãƒ¼ã‚¸2: è³‡é‡‘èª¿é”</h2>
                <p>ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã®å‘½ç¶±ã§ã‚ã‚‹è³‡é‡‘ã‚’ã©ã†èª¿é”ã—ã¾ã™ã‹ï¼Ÿ</p>
                
                <div class="choices">
                    <div class="choice-button" onclick="makeChoice(2, 'self')">
                        <h3>ğŸ’° è‡ªå·±è³‡é‡‘ãƒ»å€Ÿå…¥</h3>
                        <p>çµŒå–¶ã®è‡ªç”±åº¦ã¯é«˜ã„ãŒã€ãƒªã‚¹ã‚¯ã‚‚è‡ªå·±è²¬ä»»ã€‚å …å®Ÿãªæˆé•·ã‚’ç›®æŒ‡ã™ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(2, 'vc')">
                        <h3>ğŸ¢ ãƒ™ãƒ³ãƒãƒ£ãƒ¼ã‚­ãƒ£ãƒ”ã‚¿ãƒ«</h3>
                        <p>å¤§å‹è³‡é‡‘èª¿é”ã§æ€¥æˆé•·ã€‚çµŒå–¶ã¸ã®é–¢ä¸ã¨ã‚¨ã‚°ã‚¸ãƒƒãƒˆåœ§åŠ›ã‚ã‚Šã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(2, 'crowd')">
                        <h3>ğŸ‘¥ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ•ã‚¡ãƒ³ãƒ‡ã‚£ãƒ³ã‚°</h3>
                        <p>æ”¯æ´è€…ï¼é¡§å®¢ã€‚ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°åŠ¹æœã‚‚æœŸå¾…ã§ãã‚‹ãŒã€å®Ÿè¡Œè²¬ä»»é‡å¤§ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(2, 'grant')">
                        <h3>ğŸ›ï¸ è£œåŠ©é‡‘ãƒ»åŠ©æˆé‡‘</h3>
                        <p>è¿”æ¸ˆä¸è¦ã®è³‡é‡‘ã€‚ç”³è«‹æ‰‹ç¶šããŒè¤‡é›‘ã§ã€ä½¿é€”ã«åˆ¶é™ã‚ã‚Šã€‚</p>
                    </div>
                </div>

                <div class="visual-container" id="stage2-visuals"></div>
                <div id="stage2-feedback"></div>
            </div>

            <!-- Stage 3: çµŒå–¶åˆ¤æ–­ -->
            <div class="stage-container" id="stage3">
                <h2 class="stage-title">ã‚¹ãƒ†ãƒ¼ã‚¸3: çµŒå–¶åˆ¤æ–­</h2>
                <p>ä¼šç¤¾ã®åŸºç›¤ã¨ãªã‚‹é‡è¦ãªçµŒå–¶æ–¹é‡ã‚’æ±ºå®šã—ã¾ã—ã‚‡ã†ã€‚</p>
                
                <div class="choices">
                    <div class="choice-button" onclick="makeChoice(3, 'talent')">
                        <h3>ğŸ‘¥ å„ªç§€äººæã®ç²å¾—é‡è¦–</h3>
                        <p>æœ€é«˜ã®äººæã«æŠ•è³‡ã€‚äººä»¶è²»ã¯é«˜ã„ãŒã€ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³åŠ›ã«æœŸå¾…ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(3, 'speed')">
                        <h3>âš¡ ã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–ã®é–‹ç™º</h3>
                        <p>å¸‚å ´æŠ•å…¥ã‚’æœ€å„ªå…ˆã€‚å®Œæˆåº¦ã‚ˆã‚Šåå¾©æ”¹å–„ã§å‹è² ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(3, 'quality')">
                        <h3>âœ¨ å“è³ªãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰é‡è¦–</h3>
                        <p>æœ€é«˜å“è³ªã§å·®åˆ¥åŒ–ã€‚æ™‚é–“ã¯ã‹ã‹ã‚‹ãŒã€é¡§å®¢ãƒ­ã‚¤ãƒ¤ãƒªãƒ†ã‚£ã‚’ç²å¾—ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(3, 'partner')">
                        <h3>ğŸ¤ æˆ¦ç•¥çš„ææºé‡è¦–</h3>
                        <p>å¤§æ‰‹ä¼æ¥­ã¨ã®å”æ¥­ã§æˆé•·åŠ é€Ÿã€‚è‡ªç”±åº¦ã¨å¼•ãæ›ãˆã«ãƒªã‚½ãƒ¼ã‚¹ç²å¾—ã€‚</p>
                    </div>
                </div>

                <div class="visual-container" id="stage3-visuals"></div>
                <div id="stage3-feedback"></div>
            </div>

            <!-- Stage 4: å±æ©Ÿç®¡ç† -->
            <div class="stage-container" id="stage4">
                <h2 class="stage-title">ã‚¹ãƒ†ãƒ¼ã‚¸4: å±æ©Ÿç®¡ç†</h2>
                <p>äºˆæœŸã›ã¬å±æ©ŸãŒç™ºç”Ÿï¼ã©ã†ä¹—ã‚Šè¶Šãˆã¾ã™ã‹ï¼Ÿ</p>
                
                <div class="choices">
                    <div class="choice-button" onclick="makeChoice(4, 'transparent')">
                        <h3>ğŸ“¢ é€æ˜æ€§é‡è¦–ã®å¯¾å¿œ</h3>
                        <p>å•é¡Œã‚’å…¬é–‹ã—ã€èª å®Ÿã«å¯¾å¿œã€‚ä¿¡é ¼å›å¾©ã¸ã®é“ã¯é•·ã„ãŒç¢ºå®Ÿã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(4, 'pivot')">
                        <h3>ğŸ”„ äº‹æ¥­ãƒ”ãƒœãƒƒãƒˆ</h3>
                        <p>å±æ©Ÿã‚’æ©Ÿä¼šã«å¤‰ãˆã‚‹å¤§èƒ†ãªæ–¹å‘è»¢æ›ã€‚ãƒªã‚¹ã‚¯ã¯é«˜ã„ãŒæˆåŠŸã™ã‚Œã°é£›èºã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(4, 'cost')">
                        <h3>âœ‚ï¸ ã‚³ã‚¹ãƒˆå‰Šæ¸›ã§è€ãˆã‚‹</h3>
                        <p>å®ˆã‚Šã®çµŒå–¶ã§ç”Ÿãæ®‹ã‚Šã‚’å›³ã‚‹ã€‚æˆé•·ã¯æ­¢ã¾ã‚‹ãŒã€åŸºç›¤ã‚’å®ˆã‚‹ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(4, 'support')">
                        <h3>ğŸ¤² å¤–éƒ¨æ”¯æ´ã‚’æ±‚ã‚ã‚‹</h3>
                        <p>æŠ•è³‡å®¶ã‚„å–å¼•å…ˆã«åŠ©ã‘ã‚’æ±‚ã‚ã‚‹ã€‚ãƒ—ãƒ©ã‚¤ãƒ‰ã‚ˆã‚Šå­˜ç¶šã‚’å„ªå…ˆã€‚</p>
                    </div>
                </div>

                <div class="visual-container" id="stage4-visuals"></div>
                <div id="stage4-feedback"></div>
            </div>

            <!-- Stage 5: æˆé•·ãƒ•ã‚§ãƒ¼ã‚º -->
            <div class="stage-container" id="stage5">
                <h2 class="stage-title">ã‚¹ãƒ†ãƒ¼ã‚¸5: æˆé•·ãƒ•ã‚§ãƒ¼ã‚º</h2>
                <p>ä¼šç¤¾ã¯æˆé•·æœŸã«å…¥ã‚Šã¾ã—ãŸã€‚æ¬¡ãªã‚‹ä¸€æ‰‹ã¯ï¼Ÿ</p>
                
                <div class="choices">
                    <div class="choice-button" onclick="makeChoice(5, 'expand')">
                        <h3>ğŸ“ˆ ç©æ¥µçš„ãªäº‹æ¥­æ‹¡å¤§</h3>
                        <p>æ–°å¸‚å ´ãƒ»æ–°äº‹æ¥­ã¸æŒ‘æˆ¦ã€‚ãƒªã‚¹ã‚¯ã‚’å–ã£ã¦å¤§ããªæˆé•·ã‚’ç‹™ã†ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(5, 'stable')">
                        <h3>ğŸ° å …å®Ÿãªæˆé•·è·¯ç·š</h3>
                        <p>æ—¢å­˜äº‹æ¥­ã‚’æ·±åŒ–ã€‚ç€å®Ÿãªæˆé•·ã§é•·æœŸçš„ãªä¼æ¥­ä¾¡å€¤ã‚’å‰µé€ ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(5, 'global')">
                        <h3>ğŸŒ æµ·å¤–å±•é–‹</h3>
                        <p>ã‚°ãƒ­ãƒ¼ãƒãƒ«å¸‚å ´ã¸é€²å‡ºã€‚æ–‡åŒ–ã®å£ã¯ã‚ã‚‹ãŒã€å·¨å¤§ãªå¸‚å ´ãŒå¾…ã¤ã€‚</p>
                    </div>
                    <div class="choice-button" onclick="makeChoice(5, 'social')">
                        <h3>ğŸ’š ç¤¾ä¼šè²¢çŒ®é‡è¦–</h3>
                        <p>åˆ©ç›Šã‚ˆã‚Šç¤¾ä¼šçš„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã€‚B Corpèªè¨¼ã‚’ç›®æŒ‡ã™æ–°ã—ã„çµŒå–¶ã€‚</p>
                    </div>
                </div>

                <div class="visual-container" id="stage5-visuals"></div>
                <div id="stage5-feedback"></div>
            </div>

            <!-- ã‚µãƒãƒªãƒ¼ç”»é¢ -->
            <div class="summary-container" id="summary">
                <h2 class="stage-title">ğŸ‰ èµ·æ¥­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†ï¼</h2>
                
                <div class="company-summary">
                    <h3>ã‚ãªãŸã®ä¼šç¤¾ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h3>
                    <div id="final-company-visual"></div>
                    <div id="entrepreneur-type"></div>
                </div>

                <div class="decision-history">
                    <h3>æ„æ€æ±ºå®šã®è»Œè·¡</h3>
                    <div id="decision-list"></div>
                </div>

                <div id="final-advice"></div>

                <button class="btn-primary" onclick="generatePDF()">
                    ğŸ“„ çµæœã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                </button>
                <button class="btn-primary" onclick="restart()">
                    ğŸ”„ ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤
                </button>
            </div>
        </div>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†
        const gameState = {
            currentStage: 1,
            decisions: {},
            companyProfile: {
                name: '',
                industry: '',
                funding: '',
                strategy: '',
                crisis: '',
                growth: ''
            }
        };

        // å„é¸æŠè‚¢ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿
        const feedbackData = {
            1: { // èµ·æ¥­ã‚¢ã‚¤ãƒ‡ã‚¢
                tech: {
                    success: ['æœ€æ–°æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰ã®æŠŠæ¡', 'å„ªç§€ãªã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ç¢ºä¿', 'ç¶™ç¶šçš„ãªã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³'],
                    danger: ['æŠ€è¡“åé‡ã«ã‚ˆã‚‹é¡§å®¢ãƒ‹ãƒ¼ã‚ºè»½è¦–', 'ç«¶åˆã¨ã®å·®åˆ¥åŒ–ä¸è¶³', 'é–‹ç™ºã‚³ã‚¹ãƒˆã®è‚¥å¤§åŒ–']
                },
                health: {
                    success: ['åŒ»ç™‚å¾“äº‹è€…ã¨ã®é€£æº', 'è¦åˆ¶å¯¾å¿œã®å°‚é–€çŸ¥è­˜', 'ç¤¾ä¼šçš„ä½¿å‘½æ„Ÿã®å…±æœ‰'],
                    danger: ['è–¬äº‹æ³•é•åãƒªã‚¹ã‚¯', 'é–‹ç™ºæœŸé–“ã®é•·æœŸåŒ–', 'åŒ»ç™‚äº‹æ•…ã¸ã®å¯¾å¿œä¸å‚™']
                },
                eco: {
                    success: ['SDGsç›®æ¨™ã¨ã®æ•´åˆæ€§', 'ESGæŠ•è³‡å®¶ã¸ã®ã‚¢ãƒ”ãƒ¼ãƒ«', 'åœ°åŸŸç¤¾ä¼šã¨ã®å”åƒ'],
                    danger: ['åç›ŠåŒ–ã®é…ã‚Œ', 'ã‚°ãƒªãƒ¼ãƒ³ã‚¦ã‚©ãƒƒã‚·ãƒ³ã‚°æ‰¹åˆ¤', 'æŠ€è¡“çš„å®Ÿç¾æ€§ã®ç”˜ã•']
                },
                edu: {
                    success: ['æ•™è‚²ç¾å ´ã®ãƒ‹ãƒ¼ã‚ºæŠŠæ¡', 'ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãƒ™ãƒ¼ã‚¹ã®åŠ¹æœæ¸¬å®š', 'ç¶™ç¶šçš„ãªå­¦ç¿’ä½“é¨“'],
                    danger: ['æ•™è‚²æ ¼å·®ã®åŠ©é•·', 'ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ä¸è¶³', 'æ•™è‚²åŠ¹æœã®éå¤§è©•ä¾¡']
                }
            },
            2: { // è³‡é‡‘èª¿é”
                self: {
                    success: ['çµŒå–¶ã®è‡ªç”±åº¦ç¢ºä¿', 'ãƒªãƒ¼ãƒ³ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—å®Ÿè·µ', 'ç€å®Ÿãªè²¡å‹™ç®¡ç†'],
                    danger: ['å€‹äººç ´ç”£ãƒªã‚¹ã‚¯', 'æˆé•·é€Ÿåº¦ã®åˆ¶é™', 'è³‡é‡‘ã‚·ãƒ§ãƒ¼ãƒˆã®å±é™º']
                },
                vc: {
                    success: ['ãƒ¡ãƒ³ã‚¿ãƒ¼ã‚·ãƒƒãƒ—æ´»ç”¨', 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ‹¡å¤§', 'æˆé•·æˆ¦ç•¥ã®æ˜ç¢ºåŒ–'],
                    danger: ['çµŒå–¶æ¨©ã®å¸Œè–„åŒ–', 'ã‚¨ã‚°ã‚¸ãƒƒãƒˆåœ§åŠ›', 'çŸ­æœŸæˆæœã¸ã®ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼']
                },
                crowd: {
                    success: ['ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å½¢æˆ', 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°åŠ¹æœ', 'æ”¯æ´è€…ã®å£°ã®æ´»ç”¨'],
                    danger: ['å®Ÿè¡Œè²¬ä»»ã®é‡ã•', 'æœŸå¾…å€¤ç®¡ç†ã®å¤±æ•—', 'ãƒªã‚¿ãƒ¼ãƒ³è¨­è¨ˆã®ç”˜ã•']
                },
                grant: {
                    success: ['å…¬çš„ä¿¡ç”¨ã®ç²å¾—', 'è¿”æ¸ˆä¸è¦ã®å®‰å¿ƒæ„Ÿ', 'ç¤¾ä¼šçš„æ„ç¾©ã®æ˜ç¢ºåŒ–'],
                    danger: ['ç”³è«‹æ›¸é¡ã®è² æ‹…', 'ä½¿é€”åˆ¶é™ã¸ã®å¯¾å¿œ', 'ç¶™ç¶šæ€§ã®æ¬ å¦‚']
                }
            },
            3: { // çµŒå–¶åˆ¤æ–­
                talent: {
                    success: ['ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³å‰µå‡ºåŠ›', 'ãƒãƒ¼ãƒ æ–‡åŒ–ã®é†¸æˆ', 'çŸ¥çš„è²¡ç”£ã®è“„ç©'],
                    danger: ['äººä»¶è²»ã®é«˜é¨°', 'çµ„ç¹”ã®ç¡¬ç›´åŒ–', 'ã‚¹ã‚¿ãƒ¼ä¾å­˜ç—‡']
                },
                speed: {
                    success: ['å¸‚å ´ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ´»ç”¨', 'ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«é–‹ç™º', 'å…ˆè¡Œè€…åˆ©ç›Š'],
                    danger: ['å“è³ªå•é¡Œã®ç™ºç”Ÿ', 'ãƒ–ãƒ©ãƒ³ãƒ‰æ¯€æ', 'æŠ€è¡“çš„è² å‚µã®è“„ç©']
                },
                quality: {
                    success: ['é¡§å®¢ãƒ­ã‚¤ãƒ¤ãƒªãƒ†ã‚£', 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¾¡æ ¼è¨­å®š', 'å£ã‚³ãƒŸåŠ¹æœ'],
                    danger: ['å¸‚å ´æŠ•å…¥ã®é…ã‚Œ', 'å®Œç’§ä¸»ç¾©ã®ç½ ', 'é«˜ã‚³ã‚¹ãƒˆä½“è³ª']
                },
                partner: {
                    success: ['ãƒªã‚½ãƒ¼ã‚¹è£œå®Œ', 'ä¿¡ç”¨åŠ›å‘ä¸Š', 'å¸‚å ´ã‚¢ã‚¯ã‚»ã‚¹'],
                    danger: ['ä¾å­˜ä½“è³ª', 'åˆ©ç›Šé…åˆ†ã®å¯¾ç«‹', 'è‡ªä¸»æ€§ã®å–ªå¤±']
                }
            },
            4: { // å±æ©Ÿç®¡ç†
                transparent: {
                    success: ['ä¿¡é ¼å›å¾©', 'ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼æ”¯æŒ', 'çµ„ç¹”å­¦ç¿’'],
                    danger: ['ä¸€æ™‚çš„ãªè©•åˆ¤ä½ä¸‹', 'è¨´è¨Ÿãƒªã‚¹ã‚¯', 'éåº¦ãªæƒ…å ±é–‹ç¤º']
                },
                pivot: {
                    success: ['æ–°å¸‚å ´é–‹æ‹“', 'çµ„ç¹”æ´»æ€§åŒ–', 'å±æ©Ÿã®æ©Ÿä¼šè»¢æ›'],
                    danger: ['æ—¢å­˜é¡§å®¢ã®é›¢å', 'æ–¹å‘æ€§ã®æ··ä¹±', 'ãƒªã‚½ãƒ¼ã‚¹æµªè²»']
                },
                cost: {
                    success: ['ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼æ”¹å–„', 'ç­‹è‚‰è³ªãªçµ„ç¹”', 'ç”Ÿå­˜ç¢ºç‡å‘ä¸Š'],
                    danger: ['å„ªç§€äººæã®æµå‡º', 'ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³åœæ»', 'å¸‚å ´ã‚·ã‚§ã‚¢ä½ä¸‹']
                },
                support: {
                    success: ['è³‡é‡‘ç¢ºä¿', 'çµŒå–¶çŸ¥è¦‹ç²å¾—', 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¼·åŒ–'],
                    danger: ['äº¤æ¸‰åŠ›ä½ä¸‹', 'ä¸åˆ©ãªæ¡ä»¶å—å…¥', 'è‡ªç«‹æ€§å–ªå¤±']
                }
            },
            5: { // æˆé•·ãƒ•ã‚§ãƒ¼ã‚º
                expand: {
                    success: ['å¸‚å ´ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—', 'è¦æ¨¡ã®çµŒæ¸ˆ', 'ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ç¶™ç¶š'],
                    danger: ['ã‚ªãƒ¼ãƒãƒ¼ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³', 'å“è³ªç®¡ç†å›°é›£', 'çµ„ç¹”æ–‡åŒ–å¸Œè–„åŒ–']
                },
                stable: {
                    success: ['æŒç¶šå¯èƒ½ãªæˆé•·', 'å¼·å›ºãªåŸºç›¤', 'å¾“æ¥­å“¡æº€è¶³åº¦'],
                    danger: ['æˆé•·æ©Ÿä¼šã®é€¸å¤±', 'ç«¶åˆã®è¿½ã„ä¸Šã’', 'ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³']
                },
                global: {
                    success: ['å·¨å¤§å¸‚å ´ã‚¢ã‚¯ã‚»ã‚¹', 'ãƒ–ãƒ©ãƒ³ãƒ‰ä¾¡å€¤å‘ä¸Š', 'ãƒªã‚¹ã‚¯åˆ†æ•£'],
                    danger: ['æ–‡åŒ–çš„è¡çª', 'è¦åˆ¶å¯¾å¿œè¤‡é›‘åŒ–', 'ç®¡ç†ã‚³ã‚¹ãƒˆå¢—å¤§']
                },
                social: {
                    success: ['ç¤¾ä¼šçš„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ', 'ãƒŸãƒ¬ãƒ‹ã‚¢ãƒ«ä¸–ä»£æ”¯æŒ', 'ESGè©•ä¾¡å‘ä¸Š'],
                    danger: ['åç›Šæ€§ã®èª²é¡Œ', 'æ ªä¸»ã¨ã®å¯¾ç«‹', 'ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ‰ãƒªãƒ•ãƒˆ']
                }
            }
        };

        // ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ç”Ÿæˆé–¢æ•°
        function generateVisuals(stage, choice) {
            const container = document.getElementById(`stage${stage}-visuals`);
            container.innerHTML = '';

            // ãƒ­ã‚´ç”Ÿæˆ
            const logoBox = createVisualBox('ä¼šç¤¾ãƒ­ã‚´', 'logo');
            container.appendChild(logoBox);
            drawLogo(logoBox.querySelector('canvas'), choice);

            // ã‚ªãƒ•ã‚£ã‚¹ç”Ÿæˆ
            const officeBox = createVisualBox('ã‚ªãƒ•ã‚£ã‚¹é¢¨æ™¯', 'office');
            container.appendChild(officeBox);
            drawOffice(officeBox.querySelector('canvas'), choice);

            // ãƒãƒ¼ãƒ ç”Ÿæˆ
            const teamBox = createVisualBox('ãƒãƒ¼ãƒ ', 'team');
            container.appendChild(teamBox);
            drawTeam(teamBox.querySelector('canvas'), choice);
        }

        function createVisualBox(title, type) {
            const box = document.createElement('div');
            box.className = 'visual-box';
            box.innerHTML = `
                <h4>${title}</h4>
                <canvas class="visual-canvas" width="200" height="150"></canvas>
            `;
            return box;
        }

        // ã‚­ãƒ£ãƒ³ãƒã‚¹æç”»é–¢æ•°
        function drawLogo(canvas, choice) {
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // é¸æŠã«å¿œã˜ãŸãƒ­ã‚´ãƒ‡ã‚¶ã‚¤ãƒ³
            const logoDesigns = {
                tech: () => {
                    ctx.fillStyle = '#667eea';
                    ctx.beginPath();
                    ctx.moveTo(100, 30);
                    ctx.lineTo(130, 90);
                    ctx.lineTo(70, 90);
                    ctx.closePath();
                    ctx.fill();
                    ctx.strokeStyle = '#764ba2';
                    ctx.lineWidth = 3;
                    ctx.stroke();
                },
                health: () => {
                    ctx.fillStyle = '#e74c3c';
                    ctx.fillRect(85, 50, 30, 70);
                    ctx.fillRect(70, 65, 60, 30);
                    ctx.fillStyle = 'white';
                    ctx.fillRect(95, 70, 10, 30);
                    ctx.fillRect(90, 75, 20, 10);
                },
                eco: () => {
                    ctx.fillStyle = '#27ae60';
                    ctx.beginPath();
                    ctx.arc(100, 75, 30, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.fillStyle = '#2ecc71';
                    for(let i = 0; i < 6; i++) {
                        ctx.beginPath();
                        ctx.arc(100 + Math.cos(i * Math.PI / 3) * 25, 
                               75 + Math.sin(i * Math.PI / 3) * 25, 10, 0, Math.PI * 2);
                        ctx.fill();
                    }
                },
                edu: () => {
                    ctx.fillStyle = '#3498db';
                    ctx.fillRect(70, 50, 60, 50);
                    ctx.fillStyle = '#2980b9';
                    ctx.beginPath();
                    ctx.moveTo(70, 50);
                    ctx.lineTo(100, 30);
                    ctx.lineTo(130, 50);
                    ctx.closePath();
                    ctx.fill();
                },
                // è³‡é‡‘èª¿é”ã®é¸æŠã«å¿œã˜ãŸãƒ­ã‚´ä¿®é£¾
                self: () => {
                    ctx.strokeStyle = '#f39c12';
                    ctx.lineWidth = 3;
                    ctx.strokeRect(60, 40, 80, 80);
                },
                vc: () => {
                    ctx.strokeStyle = '#9b59b6';
                    ctx.lineWidth = 5;
                    ctx.beginPath();
                    ctx.arc(100, 75, 40, 0, Math.PI * 2);
                    ctx.stroke();
                },
                crowd: () => {
                    for(let i = 0; i < 5; i++) {
                        ctx.fillStyle = `hsla(${i * 60}, 70%, 60%, 0.7)`;
                        ctx.beginPath();
                        ctx.arc(70 + i * 15, 100 - i * 10, 8, 0, Math.PI * 2);
                        ctx.fill();
                    }
                },
                grant: () => {
                    ctx.strokeStyle = '#34495e';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 5]);
                    ctx.strokeRect(55, 35, 90, 90);
                    ctx.setLineDash([]);
                }
            };

            // æ—¢å­˜ã®é¸æŠã«åŸºã¥ã„ã¦ãƒ­ã‚´ã‚’æç”»
            Object.keys(gameState.decisions).forEach(stage => {
                const decision = gameState.decisions[stage];
                if (logoDesigns[decision]) {
                    logoDesigns[decision]();
                }
            });
            
            if (logoDesigns[choice]) {
                logoDesigns[choice]();
            }
        }

        function drawOffice(canvas, choice) {
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ã‚ªãƒ•ã‚£ã‚¹ã®åŸºæœ¬æç”»
            ctx.fillStyle = '#ecf0f1';
            ctx.fillRect(0, 100, 200, 50);
            
            // é¸æŠã«å¿œã˜ãŸã‚ªãƒ•ã‚£ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«
            const officeStyles = {
                tech: () => {
                    ctx.fillStyle = '#3498db';
                    for(let i = 0; i < 4; i++) {
                        ctx.fillRect(20 + i * 45, 30, 35, 60);
                    }
                },
                health: () => {
                    ctx.fillStyle = '#fff';
                    ctx.fillRect(20, 30, 160, 60);
                    ctx.strokeStyle = '#bdc3c7';
                    ctx.strokeRect(20, 30, 160, 60);
                },
                eco: () => {
                    ctx.fillStyle = '#27ae60';
                    ctx.fillRect(50, 50, 100, 40);
                    for(let i = 0; i < 3; i++) {
                        ctx.beginPath();
                        ctx.arc(70 + i * 30, 40, 15, 0, Math.PI * 2);
                        ctx.fill();
                    }
                },
                edu: () => {
                    ctx.fillStyle = '#f39c12';
                    ctx.fillRect(30, 40, 140, 50);
                    ctx.fillStyle = '#e67e22';
                    for(let i = 0; i < 5; i++) {
                        ctx.fillRect(40 + i * 25, 50, 15, 30);
                    }
                },
                // è³‡é‡‘èª¿é”ã«ã‚ˆã‚‹è¦æ¨¡æ„Ÿ
                self: () => {
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.font = '12px sans-serif';
                    ctx.fillText('Cozy Space', 70, 120);
                },
                vc: () => {
                    ctx.fillStyle = '#8e44ad';
                    ctx.fillRect(10, 20, 180, 70);
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 16px sans-serif';
                    ctx.fillText('SCALE UP', 65, 60);
                },
                crowd: () => {
                    for(let i = 0; i < 20; i++) {
                        ctx.fillStyle = `hsla(${Math.random() * 360}, 70%, 60%, 0.5)`;
                        ctx.fillRect(Math.random() * 180 + 10, Math.random() * 70 + 20, 10, 10);
                    }
                },
                grant: () => {
                    ctx.strokeStyle = '#7f8c8d';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(20, 90);
                    ctx.lineTo(100, 20);
                    ctx.lineTo(180, 90);
                    ctx.stroke();
                }
            };

            // æ—¢å­˜ã®é¸æŠã‚’åæ˜ 
            Object.keys(gameState.decisions).forEach(stage => {
                const decision = gameState.decisions[stage];
                if (officeStyles[decision]) {
                    officeStyles[decision]();
                }
            });
            
            if (officeStyles[choice]) {
                officeStyles[choice]();
            }
        }

        function drawTeam(canvas, choice) {
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ãƒãƒ¼ãƒ æ§‹æˆã‚’é¸æŠã«å¿œã˜ã¦å¤‰æ›´
            const teamConfigs = {
                tech: { count: 5, colors: ['#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6'] },
                health: { count: 6, colors: ['#e74c3c', '#ecf0f1', '#3498db', '#e74c3c', '#ecf0f1', '#3498db'] },
                eco: { count: 4, colors: ['#27ae60', '#2ecc71', '#16a085', '#1abc9c'] },
                edu: { count: 5, colors: ['#f39c12', '#e67e22', '#d35400', '#f39c12', '#e67e22'] },
                talent: { count: 3, colors: ['#8e44ad', '#9b59b6', '#8e44ad'] },
                speed: { count: 8, colors: Array(8).fill('#3498db') },
                quality: { count: 4, colors: ['#34495e', '#2c3e50', '#34495e', '#2c3e50'] },
                partner: { count: 6, colors: ['#e74c3c', '#3498db', '#e74c3c', '#3498db', '#e74c3c', '#3498db'] }
            };

            let config = teamConfigs[choice] || { count: 5, colors: ['#95a5a6'] };
            
            // æ—¢å­˜ã®æ±ºå®šã‹ã‚‰æœ€æ–°ã®è¨­å®šã‚’å–å¾—
            Object.keys(gameState.decisions).forEach(stage => {
                const decision = gameState.decisions[stage];
                if (teamConfigs[decision]) {
                    config = teamConfigs[decision];
                }
            });

            const spacing = 180 / (config.count + 1);
            
            for(let i = 0; i < config.count; i++) {
                const x = spacing * (i + 1) + 10;
                const y = 75 + Math.sin(i) * 10;
                
                // äººç‰©ã‚’æç”»
                ctx.fillStyle = config.colors[i % config.colors.length];
                ctx.beginPath();
                ctx.arc(x, y, 15, 0, Math.PI * 2);
                ctx.fill();
                
                // ä½“
                ctx.fillRect(x - 10, y + 15, 20, 25);
            }
        }

        // é¸æŠå‡¦ç†
        function makeChoice(stage, choice) {
            gameState.decisions[stage] = choice;
            
            // ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ç”Ÿæˆ
            generateVisuals(stage, choice);
            
            // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¡¨ç¤º
            showFeedback(stage, choice);
            
            // æ¬¡ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã¸ã®é·ç§»æº–å‚™
            setTimeout(() => {
                if (stage < 5) {
                    moveToNextStage();
                } else {
                    showSummary();
                }
            }, 2000);
        }

        function showFeedback(stage, choice) {
            const feedbackContainer = document.getElementById(`stage${stage}-feedback`);
            const feedback = feedbackData[stage][choice];
            
            feedbackContainer.innerHTML = `
                <div class="feedback-box">
                    <h4>æˆåŠŸã®éµ</h4>
                    <ul>
                        ${feedback.success.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                </div>
                <div class="feedback-box danger-feedback">
                    <h4>å¤±æ•—ã®è½ã¨ã—ç©´</h4>
                    <ul>
                        ${feedback.danger.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        function moveToNextStage() {
            document.getElementById(`stage${gameState.currentStage}`).classList.remove('active');
            gameState.currentStage++;
            document.getElementById(`stage${gameState.currentStage}`).classList.add('active');
            updateProgressBar();
        }

        function updateProgressBar() {
            const progress = (gameState.currentStage / 5) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        function showSummary() {
            document.getElementById(`stage${gameState.currentStage}`).classList.remove('active');
            document.getElementById('summary').classList.add('active');
            
            // èµ·æ¥­å®¶ã‚¿ã‚¤ãƒ—è¨ºæ–­
            const entrepreneurType = analyzeEntrepreneurType();
            document.getElementById('entrepreneur-type').innerHTML = `
                <h4>ã‚ãªãŸã®èµ·æ¥­å®¶ã‚¿ã‚¤ãƒ—</h4>
                <p><strong>${entrepreneurType.type}</strong></p>
                <p>${entrepreneurType.description}</p>
            `;
            
            // æ„æ€æ±ºå®šå±¥æ­´
            const decisionList = document.getElementById('decision-list');
            const stageNames = ['èµ·æ¥­ã‚¢ã‚¤ãƒ‡ã‚¢', 'è³‡é‡‘èª¿é”', 'çµŒå–¶åˆ¤æ–­', 'å±æ©Ÿç®¡ç†', 'æˆé•·æˆ¦ç•¥'];
            
            Object.keys(gameState.decisions).forEach((stage, index) => {
                const decision = gameState.decisions[stage];
                decisionList.innerHTML += `
                    <div class="decision-item">
                        <strong>${stageNames[index]}:</strong> ${getChoiceLabel(stage, decision)}
                    </div>
                `;
            });
            
            // æœ€çµ‚ã‚¢ãƒ‰ãƒã‚¤ã‚¹
            document.getElementById('final-advice').innerHTML = `
                <div class="feedback-box">
                    <h4>ç¾å®Ÿã®èµ·æ¥­ã¸ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
                    <ul>
                        <li>å¸¸ã«é¡§å®¢ã®å£°ã«è€³ã‚’å‚¾ã‘ã¾ã—ã‚‡ã†</li>
                        <li>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼ã‚’æœ€å„ªå…ˆã§ç®¡ç†ã—ã¾ã—ã‚‡ã†</li>
                        <li>å¤±æ•—ã‚’æã‚Œãšã€ç´ æ—©ãå­¦ç¿’ã—ã¾ã—ã‚‡ã†</li>
                        <li>ãƒãƒ¼ãƒ ã®æ–‡åŒ–ã¨ä¾¡å€¤è¦³ã‚’å¤§åˆ‡ã«ã—ã¾ã—ã‚‡ã†</li>
                        <li>é•·æœŸçš„ãªãƒ“ã‚¸ãƒ§ãƒ³ã‚’æŒã¡ãªãŒã‚‰ã€çŸ­æœŸçš„ãªå®Ÿè¡ŒåŠ›ã‚‚ç£¨ãã¾ã—ã‚‡ã†</li>
                    </ul>
                </div>
            `;
            
            // æœ€çµ‚ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«
            const finalCanvas = document.createElement('canvas');
            finalCanvas.width = 300;
            finalCanvas.height = 200;
            finalCanvas.className = 'visual-canvas';
            document.getElementById('final-company-visual').appendChild(finalCanvas);
            drawFinalCompanyVisual(finalCanvas);
        }

        function analyzeEntrepreneurType() {
            const types = {
                innovator: {
                    type: 'ã‚¤ãƒãƒ™ãƒ¼ã‚¿ãƒ¼å‹',
                    description: 'æŠ€è¡“é©æ–°ã¨æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã§ä¸–ç•Œã‚’å¤‰ãˆã‚ˆã†ã¨ã™ã‚‹èµ·æ¥­å®¶ã€‚ãƒªã‚¹ã‚¯ã‚’æã‚Œãšã€å¤§ããªæˆåŠŸã‚’ç›®æŒ‡ã—ã¾ã™ã€‚'
                },
                socialImpact: {
                    type: 'ç¤¾ä¼šèµ·æ¥­å®¶å‹',
                    description: 'åˆ©ç›Šã‚ˆã‚Šç¤¾ä¼šçš„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã‚’é‡è¦–ã€‚æŒç¶šå¯èƒ½ãªç¤¾ä¼šã®å®Ÿç¾ã«æƒ…ç†±ã‚’æ³¨ãèµ·æ¥­å®¶ã§ã™ã€‚'
                },
                steady: {
                    type: 'å …å®ŸçµŒå–¶å‹',
                    description: 'ç€å®Ÿãªæˆé•·ã¨å®‰å®šã‚’é‡è¦–ã€‚ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆãªãŒã‚‰ã€é•·æœŸçš„ãªæˆåŠŸã‚’ç›®æŒ‡ã—ã¾ã™ã€‚'
                },
                networker: {
                    type: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚«ãƒ¼å‹',
                    description: 'äººè„ˆã¨å”æ¥­ã‚’æ´»ã‹ã—ã¦æˆé•·ã€‚Win-Winã®é–¢ä¿‚æ§‹ç¯‰ãŒå¾—æ„ãªèµ·æ¥­å®¶ã§ã™ã€‚'
                }
            };
            
            // é¸æŠãƒ‘ã‚¿ãƒ¼ãƒ³ã«åŸºã¥ã„ã¦ã‚¿ã‚¤ãƒ—ã‚’åˆ¤å®š
            const decisions = Object.values(gameState.decisions);
            if (decisions.includes('tech') && decisions.includes('vc')) {
                return types.innovator;
            } else if (decisions.includes('eco') || decisions.includes('social')) {
                return types.socialImpact;
            } else if (decisions.includes('self') && decisions.includes('stable')) {
                return types.steady;
            } else {
                return types.networker;
            }
        }

        function getChoiceLabel(stage, choice) {
            const labels = {
                1: {
                    tech: 'ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãƒ»AI',
                    health: 'ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢ãƒ»åŒ»ç™‚',
                    eco: 'ç’°å¢ƒãƒ»ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£',
                    edu: 'æ•™è‚²ãƒ»äººæé–‹ç™º'
                },
                2: {
                    self: 'è‡ªå·±è³‡é‡‘ãƒ»å€Ÿå…¥',
                    vc: 'ãƒ™ãƒ³ãƒãƒ£ãƒ¼ã‚­ãƒ£ãƒ”ã‚¿ãƒ«',
                    crowd: 'ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ•ã‚¡ãƒ³ãƒ‡ã‚£ãƒ³ã‚°',
                    grant: 'è£œåŠ©é‡‘ãƒ»åŠ©æˆé‡‘'
                },
                3: {
                    talent: 'å„ªç§€äººæã®ç²å¾—é‡è¦–',
                    speed: 'ã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–ã®é–‹ç™º',
                    quality: 'å“è³ªãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰é‡è¦–',
                    partner: 'æˆ¦ç•¥çš„ææºé‡è¦–'
                },
                4: {
                    transparent: 'é€æ˜æ€§é‡è¦–ã®å¯¾å¿œ',
                    pivot: 'äº‹æ¥­ãƒ”ãƒœãƒƒãƒˆ',
                    cost: 'ã‚³ã‚¹ãƒˆå‰Šæ¸›ã§è€ãˆã‚‹',
                    support: 'å¤–éƒ¨æ”¯æ´ã‚’æ±‚ã‚ã‚‹'
                },
                5: {
                    expand: 'ç©æ¥µçš„ãªäº‹æ¥­æ‹¡å¤§',
                    stable: 'å …å®Ÿãªæˆé•·è·¯ç·š',
                    global: 'æµ·å¤–å±•é–‹',
                    social: 'ç¤¾ä¼šè²¢çŒ®é‡è¦–'
                }
            };
            
            return labels[stage][choice] || choice;
        }

        function drawFinalCompanyVisual(canvas) {
            const ctx = canvas.getContext('2d');
            
            // ä¼šç¤¾ã®æˆé•·ã‚’è¡¨ç¾ã™ã‚‹ç·åˆãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«
            ctx.fillStyle = '#667eea';
            ctx.fillRect(50, 100, 200, 80);
            
            // æˆé•·ã®è»Œè·¡ã‚’ç·šã§è¡¨ç¾
            ctx.strokeStyle = '#764ba2';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(50, 150);
            
            const points = Object.keys(gameState.decisions).length;
            for(let i = 0; i <= points; i++) {
                const x = 50 + (i * 200 / points);
                const y = 150 - (i * 10) - Math.random() * 20;
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // ä¼šç¤¾å
            ctx.fillStyle = '#333';
            ctx.font = 'bold 20px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Your Company', 150, 140);
        }

        async function generatePDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            
            // ã‚¿ã‚¤ãƒˆãƒ«
            pdf.setFontSize(20);
            pdf.text('ãƒ“ã‚¸ãƒã‚¹èµ·æ¥­ä½“é¨“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ', 105, 20, { align: 'center' });
            
            // æ—¥ä»˜
            pdf.setFontSize(12);
            pdf.text(`å®Ÿæ–½æ—¥: ${new Date().toLocaleDateString('ja-JP')}`, 20, 35);
            
            // èµ·æ¥­å®¶ã‚¿ã‚¤ãƒ—
            const entrepreneurType = analyzeEntrepreneurType();
            pdf.setFontSize(16);
            pdf.text('ã‚ãªãŸã®èµ·æ¥­å®¶ã‚¿ã‚¤ãƒ—', 20, 50);
            pdf.setFontSize(14);
            pdf.text(entrepreneurType.type, 20, 60);
            pdf.setFontSize(10);
            const lines = pdf.splitTextToSize(entrepreneurType.description, 170);
            pdf.text(lines, 20, 70);
            
            // æ„æ€æ±ºå®šå±¥æ­´
            pdf.setFontSize(16);
            pdf.text('æ„æ€æ±ºå®šã®è»Œè·¡', 20, 100);
            
            const stageNames = ['èµ·æ¥­ã‚¢ã‚¤ãƒ‡ã‚¢', 'è³‡é‡‘èª¿é”', 'çµŒå–¶åˆ¤æ–­', 'å±æ©Ÿç®¡ç†', 'æˆé•·æˆ¦ç•¥'];
            let yPosition = 110;
            
            Object.keys(gameState.decisions).forEach((stage, index) => {
                const decision = gameState.decisions[stage];
                pdf.setFontSize(12);
                pdf.text(`${stageNames[index]}: ${getChoiceLabel(stage, decision)}`, 20, yPosition);
                yPosition += 10;
            });
            
            // ã‚¢ãƒ‰ãƒã‚¤ã‚¹
            pdf.addPage();
            pdf.setFontSize(16);
            pdf.text('ç¾å®Ÿã®èµ·æ¥­ã¸ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹', 20, 20);
            
            const advice = [
                '1. å¸¸ã«é¡§å®¢ã®å£°ã«è€³ã‚’å‚¾ã‘ã¾ã—ã‚‡ã†',
                '2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼ã‚’æœ€å„ªå…ˆã§ç®¡ç†ã—ã¾ã—ã‚‡ã†',
                '3. å¤±æ•—ã‚’æã‚Œãšã€ç´ æ—©ãå­¦ç¿’ã—ã¾ã—ã‚‡ã†',
                '4. ãƒãƒ¼ãƒ ã®æ–‡åŒ–ã¨ä¾¡å€¤è¦³ã‚’å¤§åˆ‡ã«ã—ã¾ã—ã‚‡ã†',
                '5. é•·æœŸçš„ãªãƒ“ã‚¸ãƒ§ãƒ³ã‚’æŒã¡ãªãŒã‚‰ã€çŸ­æœŸçš„ãªå®Ÿè¡ŒåŠ›ã‚‚ç£¨ãã¾ã—ã‚‡ã†'
            ];
            
            pdf.setFontSize(10);
            advice.forEach((item, index) => {
                pdf.text(item, 20, 35 + (index * 10));
            });
            
            // ä¿å­˜
            pdf.save('èµ·æ¥­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ.pdf');
        }

        function restart() {
            gameState.currentStage = 1;
            gameState.decisions = {};
            document.getElementById('summary').classList.remove('active');
            document.getElementById('stage1').classList.add('active');
            document.getElementById('progressBar').style.width = '20%';
            
            // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¨ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚’ã‚¯ãƒªã‚¢
            for(let i = 1; i <= 5; i++) {
                document.getElementById(`stage${i}-visuals`).innerHTML = '';
                document.getElementById(`stage${i}-feedback`).innerHTML = '';
            }
            
            document.getElementById('decision-list').innerHTML = '';
        }

        // åˆæœŸåŒ–
        updateProgressBar();
    </script>
</body>
</html>