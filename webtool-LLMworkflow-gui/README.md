# LLM Workflow Editor

ビジュアルなLLMワークフロー作成ツール - プログラミング知識不要でAIワークフローを構築できる

## 概要

LLM Workflow Editorは、ドラッグ&ドロップ操作でAIワークフローを作成できるウェブベースのビジュアルエディターです。ノードベースのGUIシステムを使用して、複雑なAI処理パイプラインを直感的に構築できます。

## 特徴

### ✅ 実装済み機能

- **ビジュアルノードエディター**: ドラッグ&ドロップでノードを配置
- **ノード接続システム**: SVGベースの視覚的な接続線
- **プロパティパネル**: ノードの設定を編集
- **ワークフロー実行**: トポロジカルソートによる実行順序決定
- **ファイル操作**: ワークフローの保存・読み込み・エクスポート
- **レスポンシブUI**: モダンなダークテーマインターface

### 🔄 モック実装（開発中）

- **LLM API統合**: 現在はモックレスポンスを返す
- **ノード実行**: 実際のデータ処理の代わりにサンプルデータを使用

## サポートされるノードタイプ

| ノード | 説明 | 実装状況 |
|--------|------|----------|
| **Input** | データ入力ポイント | ✅ 完了 |
| **LLM Process** | AI言語モデル処理 | 🔄 モック |
| **Branch** | 条件分岐ロジック | 🔄 モック |
| **Merge** | 複数入力の統合 | 🔄 モック |
| **Filter** | データフィルタリング | 🔄 モック |
| **Loop** | 繰り返し処理 | 🔄 モック |
| **Custom** | カスタム処理ロジック | 🔄 モック |
| **Output** | 最終出力先 | ✅ 完了 |

## アーキテクチャ

### 技術スタック
- **Frontend**: Vanilla HTML5, CSS3, JavaScript (ES6+)
- **UI Framework**: カスタムTailwind-like CSS
- **Build**: なし（静的ファイル）
- **Dependencies**: なし（CDN使用なし）

### ファイル構成
```
webtool-LLMworkflow-gui/
├── index.html          # メインHTMLファイル
├── main.js             # 全機能を含むJavaScriptファイル  
├── styles.css          # Tailwind風のCSSスタイル
├── CLAUDE.md           # Claude Code用の開発ガイド
└── README.md           # このファイル
```

### 設計パターン
- **シングルクラス設計**: 全機能が`WorkflowEditor`クラスに集約
- **直接DOM操作**: フレームワークを使わない軽量実装
- **SVGベース描画**: ノード間の接続線はSVGで描画
- **イベント駆動**: ユーザーインタラクションに対応

## 使用方法

### 起動方法

1. **ブラウザで直接開く**:
   ```bash
   open index.html
   ```

2. **ローカルサーバーを使用**:
   ```bash
   # Python 3
   python -m http.server 8000
   
   # Node.js (http-server)
   npx http-server
   ```

### 基本操作

1. **ノード追加**: 左パネルからノードをドラッグまたはクリック
2. **ノード接続**: ノードの接続ポイントをドラッグして接続
3. **プロパティ編集**: ノードを選択して右パネルで設定
4. **ワークフロー実行**: ツールバーの「Execute」ボタンをクリック
5. **保存・読み込み**: ツールバーのファイル操作ボタンを使用

### デバッグ

ブラウザの開発者コンソールで以下のコマンドが使用可能：

```javascript
// メインエディターインスタンスにアクセス
window.workflowEditor

// ワークフローデータを確認
window.workflowEditor.workflow.nodes        // 全ノード  
window.workflowEditor.workflow.connections  // 全接続
window.workflowEditor.executionResults      // 実行結果
```

## 現在の制限事項

### 技術的制限
- **モック実装**: LLM APIコールは実際には行われない
- **データ永続化**: ブラウザセッション間でのデータ保存なし
- **リアルタイム処理**: 実際のAI処理は未実装

### 機能制限
- **高度なノードタイプ**: transform, aggregate, sortなどは未実装
- **バリデーション**: ワークフロー構造の詳細検証は限定的
- **エラーハンドリング**: 実行時エラーの詳細処理は基本的

## 開発計画・未実装課題

### 🔴 高優先度（基本機能）

#### LLM API統合
- [ ] 実際のLLM APIエンドポイント接続
  - [ ] io net API統合 (Lamma 4)
  - [ ] Cloudflare Workers経由API実装
  - [ ] llm.jsを利用してAPI周りを実装します。
  - [ ] エラーハンドリング強化
  - [ ] API呼び出し失敗時の詳細エラー表示
  - [ ] リトライ機能実装


#### データ永続化システム
- [ ] localStorage実装
  - [ ] ワークフロー自動保存
  - [ ] 設定情報保存（API設定等）
  - [ ] 履歴管理
- [ ] セッション復元機能
  - [ ] ページリロード時の状態復元
  - [ ] 未保存変更の警告
- [ ] クラウドストレージ連携
  - [ ] Google Drive統合
  - [ ] GitHub Gist統合
  - [ ] OneDrive統合

#### 高度なノード実行機能
- [ ] Filter ノード実装
  - [ ] 条件によるデータフィルタリング
  - [ ] 正規表現サポート
  - [ ] 数値範囲フィルタ
  - [ ] カスタムJavaScript条件
- [ ] Loop ノード実装
  - [ ] 配列要素のループ処理
  - [ ] 条件付きループ
  - [ ] ネストしたループ対応
  - [ ] ループブレイク条件
- [ ] Custom ノード実装
  - [ ] ユーザー定義JavaScript実行
  - [ ] NPMパッケージインポート
  - [ ] 外部API呼び出し
  - [ ] サンドボックス実行環境

### 🟡 中優先度（UI/UX改善）

#### キャンバス機能強化
- [ ] ズーム・パン機能
  - [ ] マウスホイールズーム
  - [ ] ドラッグによるパン移動
  - [ ] ズームレベル表示
  - [ ] フィット・トゥ・スクリーン機能
- [ ] ミニマップ表示
  - [ ] 全体レイアウト概要表示
  - [ ] 現在表示領域ハイライト
  - [ ] ミニマップクリックナビゲーション
- [ ] グリッド機能
  - [ ] スナップ・トゥ・グリッド
  - [ ] グリッド表示切り替え
  - [ ] カスタムグリッドサイズ

#### ノード操作強化
- [ ] ノードグループ化
  - [ ] 複数ノード選択
  - [ ] グループ化・解除
  - [ ] グループ移動・コピー
- [ ] ノード配置自動化
  - [ ] 自動レイアウト機能
  - [ ] ノード間隔自動調整
  - [ ] 整列機能（縦・横）
- [ ] 高度な接続機能
  - [ ] 複数出力ポート対応
  - [ ] 条件付き接続
  - [ ] 接続線のカスタマイズ

#### プロパティ管理強化
- [ ] 動的プロパティフォーム
  - [ ] ノードタイプ別専用UI
  - [ ] バリデーション強化
  - [ ] プレビュー機能
- [ ] 設定のインポート・エクスポート
  - [ ] テンプレート機能
  - [ ] プリセット管理
  - [ ] 設定共有機能

### 🟢 低優先度（拡張機能）

#### 高度なワークフロー機能
- [ ] 条件分岐強化
  - [ ] 複雑な条件式サポート
  - [ ] 動的ルーティング
  - [ ] 例外処理フロー
- [ ] 並列実行サポート
  - [ ] 非同期ノード実行
  - [ ] 実行順序制御
  - [ ] リソース管理
- [ ] ワークフロー合成
  - [ ] サブワークフロー埋め込み
  - [ ] ワークフロー継承
  - [ ] モジュール化

#### 分析・デバッグ機能
- [ ] 実行ログ詳細化
  - [ ] ステップ実行デバッガー
  - [ ] 中間結果表示
  - [ ] パフォーマンス分析
- [ ] ワークフロー最適化
  - [ ] 実行時間分析
  - [ ] ボトルネック検出
  - [ ] 最適化提案

#### エクスポート機能強化
- [ ] 多形式エクスポート
  - [ ] Python SDK生成
  - [ ] Node.js SDK生成
  - [ ] Docker Compose出力
  - [ ] Kubernetes YAML生成
- [ ] CI/CD統合
  - [ ] GitHub Actions連携
  - [ ] Jenkins統合
  - [ ] GitLab CI連携

#### チーム協働機能
- [ ] リアルタイム協働編集
  - [ ] WebSocketベース同期
  - [ ] 変更履歴管理
  - [ ] コンフリクト解決
- [ ] コメント・レビュー機能
  - [ ] ノード単位コメント
  - [ ] レビュー承認フロー
  - [ ] 変更通知

### 📋 技術改善課題

#### アーキテクチャ改善
- [ ] モジュール化
  - [ ] コンポーネント分離
  - [ ] 依存性注入
  - [ ] プラグインシステム
- [ ] 状態管理強化
  - [ ] Redux/Vuex風状態管理導入
  - [ ] undo/redo機能
  - [ ] 状態同期機能
- [ ] TypeScript移行
  - [ ] 型定義追加
  - [ ] 静的解析強化
  - [ ] IDE支援向上

#### パフォーマンス最適化
- [ ] 仮想スクロール実装
  - [ ] 大規模ワークフロー対応
  - [ ] メモリ使用量最適化
- [ ] 遅延読み込み
  - [ ] コード分割
  - [ ] 動的インポート
  - [ ] プリロード戦略

#### テスト・品質保証
- [ ] 単体テスト導入
  - [ ] Jest/Vitest設定
  - [ ] コンポーネントテスト
  - [ ] API mockテスト
- [ ] E2Eテスト導入
  - [ ] Playwright/Cypress設定
  - [ ] ワークフローシナリオテスト
  - [ ] CI/CD統合

#### セキュリティ強化
- [ ] XSS対策
  - [ ] Content Security Policy
  - [ ] 入力値サニタイズ
- [ ] データ暗号化
  - [ ] APIキー暗号化
  - [ ] ローカルストレージ暗号化

## 貢献・開発

### 開発環境セットアップ
```bash
# リポジトリクローン後、直接ブラウザで開くだけ
open index.html
```

### コード構造
- **main.js**: `WorkflowEditor`クラスにすべての機能が実装
- **index.html**: 3カラムレイアウト（パレット・キャンバス・プロパティ）
- **styles.css**: Tailwind風のユーティリティクラス

### 新しいノードタイプの追加方法
1. `constructor`内の`this.nodeTypes`配列に追加
2. `getIcon()`メソッドにSVGアイコンを追加
3. `getDefaultNodeData()`でデフォルトデータ構造を定義
4. `generatePropertyForm()`でプロパティフォームを実装
5. `executeNode()`で実行ロジックを実装

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 更新履歴

- **v1.0.0** (2024): 初期リリース - ビジュアルエディター基本機能
- 現在: モック実装による動作確認段階